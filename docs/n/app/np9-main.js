(()=>{var e={327:e=>{function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=["1","2","3","4","5","6","7","8","9"],r=[[0,1,2,3,4,5,6,7,8],[9,10,11,12,13,14,15,16,17],[18,19,20,21,22,23,24,25,26],[27,28,29,30,31,32,33,34,35],[36,37,38,39,40,41,42,43,44],[45,46,47,48,49,50,51,52,53],[54,55,56,57,58,59,60,61,62],[63,64,65,66,67,68,69,70,71],[72,73,74,75,76,77,78,79,80]],s=[[0,9,18,27,36,45,54,63,72],[1,10,19,28,37,46,55,64,73],[2,11,20,29,38,47,56,65,74],[3,12,21,30,39,48,57,66,75],[4,13,22,31,40,49,58,67,76],[5,14,23,32,41,50,59,68,77],[6,15,24,33,42,51,60,69,78],[7,16,25,34,43,52,61,70,79],[8,17,26,35,44,53,62,71,80]],i=[[0,1,2,9,10,11,18,19,20],[3,4,5,12,13,14,21,22,23],[6,7,8,15,16,17,24,25,26],[27,28,29,36,37,38,45,46,47],[30,31,32,39,40,41,48,49,50],[33,34,35,42,43,44,51,52,53],[54,55,56,63,64,65,72,73,74],[57,58,59,66,67,68,75,76,77],[60,61,62,69,70,71,78,79,80]];function o(e){return e%9}function a(e){return Math.floor(e/9)}function l(e,t){return function(e,t){var n=o(e),s=a(e),i=Math.floor(4.5);switch(n-=i,s-=i,t){case 0:n=-n;break;case 1:s=-s;break;case 2:n=-n,s=-s}return r[s+=i][n+=i]}(e,t)}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var c,d;return c=e,(d=[{key:"convert",value:function(e,t){var n=this.randomizeElement(e,t),r=t.getInt(4);return 3!=r&&(n=this.reverseChange(n,r)),2!=(r=t.getInt(3))&&(n=this.blockReverse(n,r)),2!=(r=t.getInt(3))&&(n=this.lineChange(n,r)),n}},{key:"getRandomSymbolArray",value:function(e){for(var t=n.slice(),r=0;r<t.length;r++){var s=t[r],i=e.getInt(t.length);t[r]=t[i],t[i]=s}var o=[];for(r=0;r<t.length;r++)o[(r+1).toString()]=t[r];return o[0]="0",o[" "]=" ",o}},{key:"randomizeElement",value:function(e,t){var n=this.getRandomSymbolArray(t);return e.map((function(e){return n[e]}))}},{key:"reverseChange",value:function(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=e[l(r,t)];return n}},{key:"blockReverse",value:function(e,t){for(var n=e.slice(),r=[[0,2,3,5,6,8],[0,1,2,6,7,8]],s=[[2,0,5,3,8,6],[6,7,8,0,1,2]],o=[[1,4,7],[3,4,5]],a=0;a<6;a++)for(var l=r[t][a],c=s[t][a],d=0;d<9;d++){var u=i[l][d],h=i[c][d];n[u]=e[h]}for(a=0;a<3;a++){var m=o[t][a];for(d=0;d<9;d++){var f=i[m][d];n[f]=e[f]}}return n}},{key:"lineChange",value:function(e,t){for(var n,i,o=e.slice(),a=[0,2,6,8],l=[2,0,8,6],c=[1,3,4,5,7],d=0;d<4;d++){0==t?(n=s[a[d]],i=s[l[d]]):(n=r[a[d]],i=r[l[d]]);for(var u=0;u<9;u++){var h=n[u],m=i[u];o[h]=e[m]}}for(d=0;d<5;d++)for(n=0==t?s[c[d]]:r[c[d]],u=0;u<9;u++){var f=n[u];o[f]=e[f]}return o}},{key:"setWarn",value:function(e){e.classList.contains("fx")||e.classList.add("w")}},{key:"setPencil",value:function(e){e.classList.contains("fx")||e.classList.add("p")}},{key:"vlCheck",value:function(e,t){for(var n=!1,r=0;r<t.length;r++)for(var s=t[r],i=0;i<t.length;i++){var o=t[i];r!=i&&e[s].textContent==e[o].textContent&&(n=!0,this.setWarn(e[s]),this.setWarn(e[o]))}return!n}},{key:"check",value:function(e){for(var t=!1,n=0;n<e.length;n++)" "==e[n].textContent&&(t=!0,this.setWarn(e[n])),e[n].textContent.length>1&&(t=!0,this.setWarn(e[n]));if(t)return!1;for(var o=[r,s,i],a=0;a<o.length;a++){var l=o[a];for(n=0;n<l.length;n++){var c=l[n];this.vlCheck(e,c)||(t=!0)}}return!t}},{key:"vl_delete",value:function(e,t,n,r){result=r;for(var s=0;s<9;s++)if(t[s]!=n){var i=e[t[s]].textContent;" "!=i&&1==i.length&&(result=result.replace(i,""))}return result}},{key:"delSymbol",value:function(e,t,n){var l,c=n;return c=this.vl_delete(e,r[a(t)],t,c),c=this.vl_delete(e,s[o(t)],t,c),(c=this.vl_delete(e,i[(l=t,3*Math.floor(a(l)/3)+Math.floor(o(l)/3))],t,c)).match(/[1-9]+/)&&(c=c.split("").join(" ")),c}},{key:"pencilMarkPos",value:function(e,t,n){this.setPencil(e[t]),e[t].textContent=this.delSymbol(e,t,n)}},{key:"pencilMark",value:function(e,t){for(var n=0;n<e.length;n++)" "==e[n].textContent&&(this.setPencil(e[n]),e[n].textContent=this.delSymbol(e,n,t))}}])&&t(c.prototype,d),Object.defineProperty(c,"prototype",{writable:!1}),e}();e.exports=c},993:e=>{function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=4294967295,r=2147483647,s=2147483647,i=3919453491,o=1123061949,a=2889872383;function l(e){return 26125*(e=(e^e>>>27^e<<19)&r)&n}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.st0=0,this.st1=0,this.st2=0,this.st3=0,this.setSeed(t)}var c,d;return c=e,(d=[{key:"setSeed",value:function(e){if("string"==typeof e||e instanceof String){var t=e.split("").map((function(e){return e.charCodeAt()}));this.setSeedArray(t)}else Array.isArray(e)?this.setSeedArray(e):this.setSeedNumber(e)}},{key:"setSeedNumber",value:function(e){var t=Array(4);t[0]=e&n,t[1]=i,t[2]=o,t[3]=a;for(var l=1;l<8;l++){var c=t[l-1&3];c=c^c>>>30^c<<17,t[3&l]^=l+30157*(c&r)}for(this.st0=t[0],this.st1=t[1],this.st2=t[2],this.st3=t[3],0==(this.st0&s)&&0==this.st1&&0==this.st2&&0==this.st3&&(this.st0="T".charCodeAt(0),this.st1="I".charCodeAt(0),this.st2="N".charCodeAt(0),this.st3="Y".charCodeAt(0)),l=0;l<8;l++)this.next()}},{key:"setSeedArray",value:function(e){if(!Array.isArray(e))throw new Error("TinyMTJS.setSeedArray: Seed type mismatch.");var t,c,d,u,h,m=Array(4);for(u=e.length,m[0]=0,m[1]=i,m[2]=o,m[3]=a,c=u+1>8?u+1:8,d=l(m[0]^m[1]^m[3]),m[1]=m[1]+d&n,d+=u,m[2]=m[2]+d&n,m[0]=d,c--,f=1,t=0;t<c&&u>0;t++)d=l(m[f%4]^m[(f+1)%4]^m[(f+4-1)%4]),m[(f+1)%4]=m[(f+1)%4]+d&n,d=d+e[t%u]+f&n,m[(f+1+1)%4]=m[(f+1+1)%4]+d&n,m[f%4]=d,f=(f+1)%4;for(t=0;t<4;t++)d=559973*(h=((h=m[f%4]+m[(f+1)%4]+m[(f+4-1)%4])^h>>>27^h<<19)&r)&n,m[(f+1)%4]^=d,d-=f,m[(f+1+1)%4]^=d,m[f%4]=d,f=(f+1)%4;this.st0=m[0],this.st1=m[1],this.st2=m[2],this.st3=m[3],0==(this.st0&s)&&0==this.st1&&0==this.st2&&0==this.st3&&(this.st0="T".charCodeAt(0),this.st1="I".charCodeAt(0),this.st2="N".charCodeAt(0),this.st3="Y".charCodeAt(0));for(var f=0;f<8;f++)this.next()}},{key:"getInt31",value:function(){return this.next()>>>1}},{key:"getDouble31",value:function(){return 1*this.getInt31()/2147483648}},{key:"getInt",value:function(e){return Math.floor(this.getDouble31()*e)}},{key:"next",value:function(){var e=this.st3,t=this.st0&s^this.st1^this.st2;e^=e>>>1^(t^=t<<1&n),this.st0=this.st1,this.st1=this.st2,this.st2=t^e<<10&n,this.st3=e,1==(1&e)&&(this.st1^=i,this.st2^=o);var r=this.st3,l=this.st0+(this.st2>>>8)&n;return r^=l,1==(1&l)&&(r^=a),r}}])&&t(c.prototype,d),Object.defineProperty(c,"prototype",{writable:!1}),e}();e.exports=c}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=n(993),r=n(327),s="problemArray9-",i={etitle:"numpl9",jtitle:"ナンプレ9",seed:""},o={},a=new r,l={L:"pz.locked9.txt",T:"pz.tuple9.txt",X:"pz.xwing9.txt"},c=new t(0);var d=function(){function t(e,n,r){switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=n.type,this.uniq=this.type+n.uniq,this.type){case"hour":case"min":this.subtitle="random",this.seed=[r,n.uniq,4294967295&e.getTime()];break;default:var s=e.getFullYear(),i=e.getMonth()+1,o=e.getDate();this.subtitle=function(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return t+"-"+("0"+n).substr(-2)+"-"+("0"+r).substr(-2)}(e),this.seed=[r,n.uniq,s,i,o]}var a=function(e,t){var n,r,s,i={},o=new Date(e);switch(t){case"day":o.setHours(23),o.setMinutes(59),o.setSeconds(59),i.seconds=Math.ceil((o.getTime()-e.getTime())/1e3);break;case"hour":o.setMinutes(59),o.setSeconds(59),i.seconds=Math.ceil((o.getTime()-e.getTime())/1e3);break;default:o.setMinutes(10*Math.ceil(e.getMinutes()/10)),o.setSeconds(59),i.seconds=Math.ceil((o.getTime()-e.getTime())/1e3)}return i.text=(r=(n=i.seconds)%60,s=Math.floor(n/60)%60,("0"+Math.floor(n/3600)).substr(-2)+":"+("0"+s).substr(-2)+":"+("0"+r).substr(-2)),i}(e,this.type);this.nokori=a.text,this.seconds=a.seconds,this.time=e.getTime()}var n,r;return n=t,(r=[{key:"finish",value:function(){var e=new Date,t=Math.ceil((e.getTime()-this.time)/1e3),n=t>=this.seconds;this.seconds=n?0:this.seconds-t}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function u(e,t){e.classList.add(t)}function h(e,t){e.classList.remove(t)}function m(e){for(var t=document.getElementById("board").getElementsByTagName("span"),n=0;n<t.length;n++)h(t[n],e)}function f(){if(m("e"),m("w"),!o.owari){var e=this.textContent;!function(e){for(var t=document.getElementById("board").getElementsByTagName("span"),n=0;n<t.length;n++)if(t[n].classList.contains("s")){t[n].textContent=e,t[n].classList.remove("w"),t[n].classList.remove("p");break}}(e)," "!=e&&function(e){for(var t=document.getElementById("board").getElementsByTagName("span"),n=0;n<t.length;n++)t[n].textContent.includes(e)&&u(t[n],"e")}(e),m("s")}}function g(){m("e"),o.owari||(function(e){for(var t=document.getElementById("board").getElementsByTagName("span"),n=0;n<t.length;n++)if(t[n].classList.contains("s")){t[n].classList.contains("p")&&(t[n].textContent=t[n].textContent.replace(e,""));break}}(this.textContent),m("s"))}function v(){o.owari||(m("s"),u(this,"s"))}function y(e,t,n,r,s,i){for(var o=0,a=0;a<n;a++){var l=!1;a%s==s-1&&a!=n-1&&(l=!0);for(var c=0;c<n;c++){var d=document.createElement("span");l&&d.classList.add("b"),c%r==r-1&&c!=n-1&&d.classList.add("r");var u=t[o++];" "!=u?d.classList.add("fx"):null!=i&&(d.onclick=i),d.textContent=u,e.appendChild(d)}}}function p(e,t,n){for(var r=0;r<t.length;r++){var s=document.createElement("span");s.textContent=t[r],null!=n&&(s.onclick=n),e.appendChild(s)}}function k(){var e=function(e,t,n){for(var r="⬜",s=0;s<t.length;s++)if(t[s].match(/[A-Za-z0-9]/)){r="_";break}var i=e+"\n";for(s=0;s<t.length;s++)" "==t[s]?i+=r:i+=t[s],s%3==2&&s%9!=8&&(i+=" "),s%9==8&&(i+="\n");return(i+="clear!\n")+(n+"\n")}(i.title,o.problem,location.href);navigator.clipboard&&navigator.clipboard.writeText(e)}function b(){if(!o.owari){for(var e=document.getElementById("board").getElementsByTagName("span"),t="",n=0;n<e.length;n++)t+=e[n].textContent;o.checkCnt++,a.check(e)?(o.answer=t,function(){m("s"),m("e"),m("w");var e=document.getElementById("check");e.disabled=!0,e.hidden=!0,document.getElementById("pen").hidden=!0,document.getElementById("reset").hidden=!0,document.getElementById("key2").hidden=!0;var t=document.getElementById("result"),n=document.getElementById("copy"),r=document.getElementById("nextgame");o.owari=!0,t.hidden=!1,n.hidden=!1,r.hidden=!1,n.disabled=!1;var s,a,l,c,d="";1==o.checkCnt?d="一発クリア、":d+=o.checkCnt+"回試行でのクリア、",t.textContent=d+"おめでとうございます",i.seed.finish(),s=i.etitle+i.seed.uniq,a=o,l=i.seed.seconds,c=encodeURIComponent(JSON.stringify(a)),document.cookie=s+"="+c+"; SameSite=Lax; max-age="+l}()):console.log("check NG")}}function w(){document.getElementById("key2").hidden=!1,document.getElementById("pen").disabled=!0}function E(){var e=document.getElementById("board").getElementsByTagName("span");m("s"),m("e"),a.pencilMark(e,o.keystr)}function I(){if(!o.owari){for(var e=document.getElementById("board").getElementsByTagName("span"),t=0;t<e.length;t++)e[t].classList.contains("fx")||(e[t].classList.remove("w"),e[t].classList.remove("p"),e[t].classList.remove("s"),e[t].textContent=" ");o.checkCnt++}}function x(){var e=document.getElementById("result"),t=document.getElementById("copy"),n=document.getElementById("nextgame");document.getElementById("loading").hidden=!0,e.hidden=!0,t.hidden=!0,n.hidden=!0,e.textContent="",o.checkCnt=0;var r=o.keystr+" ";y(document.getElementById("board"),o.problem,9,3,3,v),p(document.getElementById("key"),r,f);var s=document.getElementById("key2"),i=document.createElement("span");i.textContent="📝",i.onclick=E,s.appendChild(i),p(s,o.keystr,g)}function C(e){var t,n,r,s=e[c.getInt(e.length)];s=(s=s.trim()).replace(/"/g,""),console.log("length = "+s.length),console.log("prstr = "+s),t=s=a.convert(s.split(""),c).join(""),n=o.keystr,r=function(e){for(var t=e.split(""),n=[],r=0;r<t.length;r++)n[(r+1).toString()]=t[r];return n[0]="0",n[" "]=" ",n}(n),s=t.split("").map((function(e){return r[e]})).join(""),o.problem=s}function B(e){document.getElementById("file").hidden=!0;var t=e.target.files[0],n=new FileReader;n.readAsText(t),n.addEventListener("load",(function(){var e=this.result.trim(),t=e.split(/\n/),n=s+o.level;window.sessionStorage.setItem(n,e),C(t),x(o.level)}))}window.onload=function(){var e,t,n,r,a,u,h;e=window.matchMedia("(prefers-color-scheme: dark)").matches,t=window.sessionStorage.getItem("user"),n=document.documentElement,t?n.setAttribute("theme",t):1==e?n.setAttribute("theme","dark"):n.setAttribute("theme","light"),document.getElementById("changeMode").onclick=function(){"dark"==n.getAttribute("theme")?(n.setAttribute("theme","light"),window.sessionStorage.setItem("user","light")):(n.setAttribute("theme","dark"),window.sessionStorage.setItem("user","dark"))},r=document.getElementById("check"),a=document.getElementById("copy"),u=document.getElementById("pen"),h=document.getElementById("reset"),r.onclick=b,a.onclick=k,u.onclick=w,h.onclick=I;var m=function(){var e={},t=new URLSearchParams(window.location.search);return e.type=t.get("t"),"hour"!=e.type&&"min"!=e.type&&(e.type="day"),t.has("st")?(e.str=t.get("st"),e.str=(e.str+"123456789").substring(0,9)):e.str="123456789".substring(0,9),t.has("uq")?e.uniq=t.get("uq"):e.uniq=1,t.has("l")?e.level=t.get("l"):e.level=H,"http"==window.location.href.substring(0,4)?e.file=!1:e.file=!0,e}();o.level=m.level,o.keystr=m.str;var f=new Date;c.setSeed(o.keystr),i.seed=new d(f,m,c.getInt31()),c.setSeed(i.seed.seed);for(var g=0;g<100;g++)c.getInt31();var v=i.jtitle+o.level+"("+o.keystr+")";document.getElementById("title").textContent=v,i.title=v+i.seed.subtitle;var E=function(e){var t=new Array;if(document.cookie)for(var n=document.cookie.split("; "),r=0;r<n.length;r++){var s=n[r].split("=");t[s[0]]=decodeURIComponent(s[1])}return t[e]||""}(i.etitle+i.seed.uniq);if(!E||(function(e){if(function(e){var t=document.getElementById("board");y(t,e.problem,9,3,3,null),function(e,t){for(var n=e.getElementsByTagName("span"),r=0;r<n.length;r++)" "==n[r].textContent&&(n[r].textContent=t[r])}(t,e.answer);var n=o.keystr+" ";p(document.getElementById("key"),n,null)}(o=JSON.parse(e)),o.owari){document.getElementById("loading").hidden=!0;var t=document.getElementById("check");t.disabled=!0,t.hidden=!0,document.getElementById("pen").hidden=!0,document.getElementById("reset").hidden=!0,document.getElementById("key2").hidden=!0;var n=document.getElementById("copy");n.disabled=!1,n.hidden=!1,document.getElementById("result").textContent="次のゲームまであと "+i.seed.nokori,document.getElementById("nextgame").hidden=!1}}(E),!o.owari)){var S=s+o.level,A=window.sessionStorage.getItem(S);if(A)return problemArray=A.split("\n"),C(problemArray),void x();if(m.file){var T=document.getElementById("file");T.hidden=!1,T.addEventListener("change",B)}else{var M=new XMLHttpRequest,L="./data/"+l[o.level];M.open("get",L,!0),M.onload=function(){var e=this.responseText.trim(),t=e.split("\n"),n=s+o.level;window.sessionStorage.setItem(n,e),C(t),x(o.level)},M.send(null)}}}})()})();
//# sourceMappingURL=np9-main.js.map