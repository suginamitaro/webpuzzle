{"version":3,"file":"fz-main.js","mappings":"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","sources":["webpack://wordle/./web/factor/src/euclid.js","webpack://wordle/./web/factor/src/kz.js","webpack://wordle/./web/factor/src/log4js.js","webpack://wordle/./web/factor/src/polynomial.js","webpack://wordle/./web/factor/src/sosu.js","webpack://wordle/./web/factor/src/tinymtjs.js","webpack://wordle/./web/factor/src/util.js","webpack://wordle/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack://wordle/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://wordle/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://wordle/./node_modules/@babel/runtime/helpers/createClass.js","webpack://wordle/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://wordle/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://wordle/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://wordle/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://wordle/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://wordle/./node_modules/@babel/runtime/helpers/typeof.js","webpack://wordle/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack://wordle/./node_modules/@babel/runtime/regenerator/index.js","webpack://wordle/webpack/bootstrap","webpack://wordle/./web/factor/src/fz.js"],"sourcesContent":["/*\n * GCD 整数の最小公倍数\n */\nfunction gcdInt(x, y) {\n    if (x < 0 && y < 0) {\n        return -gcdInt2(Math.abs(x), Math.abs(y));\n    } else {\n        return gcdInt2(Math.abs(x), Math.abs(y));\n    }\n}\n\nfunction gcdInt2(x, y) {\n    if (y > x) {\n        return gcdInt(y, x);\n    }\n    var a = x;\n    var b = y;\n    while (b != 0) {\n        var t = b;\n        b = a % b;\n        a = t;\n    }\n    return a;\n}\n\nfunction lcmInt(x, y) {\n    return x * y / gcdInt(x, y);\n}\n\nfunction exgcd(x, y) {\n    if (x <= 0 || y <= 0) {\n        throw new Error('out of range');\n    }\n    var r0 = x;\n    var r1 = y;\n    var a0 = 1;\n    var a1 = 0;\n    var b0 = 0;\n    var b1 = 1;\n    while (r1 > 0) {\n        var q1 = Math.trunc(r0 / r1);\n        var r2 = r0 % r1;\n        var a2 = a0 - q1*a1\n        var b2 = b0 - q1*b1\n        r0 = r1;\n        r1 = r2;\n        a0 = a1;\n        a1 = a2;\n        b0 = b1;\n        b1 = b2;\n    }\n    return [a0, b0, r0];\n}\n\nfunction inverse(x, mod) {\n    x = (x % mod + mod) % mod;\n    const r = exgcd(x, mod);\n    if (r[2] == 1) {\n        return (r[0] + mod) % mod;\n    } else {\n        // console.log('r[2] = ' + r[2]);\n        // console.log('x = ' + x);\n        // console.log('mod = ' + mod);\n        throw new Error('gcd is not 1');\n    }\n}\n\nexports.gcdInt = gcdInt;\nexports.exgcd = exgcd;\nexports.lcmInt = lcmInt;\nexports.inverse = inverse;\n","const polymodule = require('./polynomial');\nconst eucmodule = require('./euclid');\nconst sosumd = require('./sosu');\nconst tinymd = require('./tinymtjs');\nconst utlmd = require('./util');\nconst Polynomial = polymodule.Polynomial;\nconst PolynomialMP = polymodule.PolynomialMP;\nconst inverse = eucmodule.inverse;\nconst Sosu = sosumd.Sosu;\nconst MulCMB = sosumd.MulCMB;\nconst TinyMTJS = tinymd.TinyMTJS;\n//const combgenerator = utlmd.combgenerator;\nconst createCombinationGeneratorAll = utlmd.createCombinationGeneratorAll;\n\nconst log4js = require('./log4js')\nconst logger = log4js.getLogger();\n// fatal\n// error\n// warn\n// info\n// debug\n// trace\n//logger.level = 'debug';\nlogger.level = 'fatal';\n\n/*\n * ないときだけpush\n * arは破壊される\n */\nfunction uniqPush(ar, el) {\n    for (var i = 0; i < ar.length; i++) {\n        if (ar[i].equal(el)) {\n            return ar;\n        }\n    }\n    ar.push(el);\n    return ar;\n}\n\n/*\n * el をmonic に変換\n * ないときだけpush\n * arは破壊される\n */\nfunction uniqPushMonic(ar, el) {\n    if (el.canBeMonic()) {\n        el = el.toMonic();\n    }\n    return uniqPush(ar, el);\n}\n\nfunction randomPMP(indet, deg, mod, tiny) {\n    var ar = new Array(deg + 1);\n    for (var i = 0; i <= deg; i++) {\n        var r = tiny.getInt(mod);\n        ar[i] = r;\n    }\n    while(ar[deg] == 0) {\n        ar[deg] = tiny.getInt(mod-1)+1;\n    }\n    return new PolynomialMP(indet, ar, mod);\n}\n\nfunction arModToInt(array, mod, mul) {\n    var ar = array.concat();\n    var half = mod / 2;\n    for (var i = 0; i < ar.length; i++) {\n        ar[i] = (ar[i] * mul) % mod;\n        if (ar[i] > half) {\n            ar[i] = ar[i] - mod;\n        }\n    }\n    return ar;\n}\n\nfunction czpower(poly, p, d, modp) {\n    const m = (p - 1) / 2;\n    var fp = poly;\n    var f = new PolynomialMP(poly.indet, [1], poly.base);\n    for (let n = 1; n < d; n++) {\n        f = fp.power(m).mul(f).divRem(modp)[1];\n        fp = fp.powerP().divRem(modp)[1];\n    }\n    return f;\n}\n\nfunction powerOfMP(poly) {\n    const prime = poly.base;\n    var ar1 = poly.ar.concat();\n    var ar2 = [];\n    var finish = false;\n    var cnt = 0;\n    while (!finish) {\n        for (let i = 0; i < ar1.length; i++) {\n            if (i % prime == 0) {\n                ar2.push(ar1[i]);\n            } else if (ar1[i] != 0) {\n                finish = true;\n                break;\n            }\n        }\n        if (finish) {\n            break;\n        }\n        ar1 = ar2;\n        ar2 = [];\n        cnt += prime;\n    }\n    return [new PolynomialMP(poly.indet, ar1, poly.mod, poly.base),\n            cnt];\n}\n\nfunction squareFreeMP(poly) {\n    logger.debug('in squareFreeMP poly = ' + poly);\n    const diffP = poly.d();\n    logger.debug('diffP = ' + diffP);\n    // ちょうどP乗だった\n    if (diffP.isZero()) {\n        let tmp = powerOfMP(poly);\n        logger.debug('just power of P');\n        return [tmp[0], tmp[1], null];\n    }\n    const gcd = poly.gcd(diffP).toMonic();\n    logger.debug('gcd = ' + gcd);\n    // gcd が 1\n    if (gcd.deg() <= 0) {\n        logger.debug('only rest');\n        return [gcd, 1, poly];\n    }\n    var n = 0;\n    var work = poly;\n    var res = work.divRem(gcd);\n    logger.debug('res[0] = ' + res[0]);\n    logger.debug('res[1] = ' + res[1]);\n    return [gcd, 1, res[0]];\n}\n\nfunction reduceFactor(factor) {\n    logger.debug('in reduceFactor');\n    var result = [];\n    factor.forEach(el => {\n        const e = result.find(ar => ar[0].equal(el[0]));\n        if (!e) {\n            logger.debug('push ' + el[0] + el[1]);\n            result.push(el);\n        } else {\n            logger.debug('inc ' + e[1] + ',' + el[1]);\n            e[1] += el[1];\n        }\n    });\n    return result;\n}\n\n/*\n * Distinct Degree Factorization on GF(p)\n * freeMP, prime -> array of polynomialMP\n * https://en.wikipedia.org/wiki/Factorization_of_polynomials_over_finite_fields  (2022-11-20)\n */\nfunction ddf(free, prime, tee, tp) {\n    free = free.toMonic();\n    if (logger.isDebugEnabled()) {\n        logger.debug('in ddf prime = ' + prime\n                     + ' free = ' + free.toString());\n    }\n    // const deg = free.deg();\n    if (free.deg() <= 1) {\n        logger.debug('out ddf ddfactors:' + free.toString() +\n                     ',' + free.deg());\n        return [[free, free.deg()]];\n    }\n    var ddfactors = [];\n    var cnt = 1;\n    while (free.deg() >= 2 * cnt) {\n        var tmp = tp.sub(tee);\n        const g = free.gcd(tmp).toMonic();\n        // const g = free.gcd(tmp);\n        if (logger.isDebugEnabled()) {\n            logger.debug('cnt = ' + cnt);\n            logger.debug('free = ' + free);\n            logger.debug('tp = ' + tp);\n            logger.debug('tmp = ' + tmp);\n            logger.debug('g = ' + g);\n        }\n        if (g.deg() > 0) {\n            logger.debug('g = ' + g + ' cnt = ' + cnt);\n            ddfactors.push([g, cnt]);\n            free = free.divRem(g)[0].toMonic();\n        }\n        cnt++;\n        // このあと足し算するのにtomonic しちゃいかんでしょ\n        // tp = tp.powerPMod(free).toMonic();\n        tp = tp.powerPMod(free);\n    }\n    if (free.deg() > 0) {\n        // logger.info('doubtful?');\n        logger.debug('free.deg() > 0 ' + free);\n        ddfactors.push([free, free.deg()]);\n    }\n    if (ddfactors.length == 0) {\n        // return [[free, 1]];\n        logger.debug('length == 0 ' + free);\n        ddfactors.push([free, free.deg()]);\n    }\n    if (logger.isDebugEnabled()) {\n        logger.debug('out ddf ddfactors:');\n        ddfactors.forEach(pr => {\n            logger.debug(pr[0].toString() + ',' + pr[1]);\n        });\n    }\n    return ddfactors;\n}\n\n/*\n * Equal Degree Factorization on GF(p) by Cantor–Zassenhaus\n * freeMP, deg, prime -> array of polynomialMP\n * https://en.wikipedia.org/wiki/Factorization_of_polynomials_over_finite_fields\n *  (2022-11-20 ver.)\n */\nfunction edfcz(free, deg, prime, one, tinymt) {\n    if (prime == 2) {\n        logger.fatal('not supported prime:' + prime);\n        throw new Error('not supported prime');\n    }\n    if (logger.isDebugEnabled()) {\n        logger.debug('in edfcz free = ' + free + ' deg = ' + deg +\n                     ' prime = ' + prime + ' one = ' + one);\n    }\n    const r = free.deg() / deg;\n    var inlist = [free];\n    var outlist = [];\n    var inlist2 = [];\n    while (outlist.length < r) {\n        if (inlist.length == 0) {\n            logger.fatal('empty');\n            break;\n        }\n        // var rndp = randomPMP(free.indet, free.deg()-1, prime, this.tinymt);\n        var rndp = randomPMP(free.indet, free.deg()-1, prime, tinymt);\n        logger.debug('rndp1 = ' + rndp);\n        rndp = czpower(rndp, prime, free.deg(), free).sub(one);\n        logger.debug('rndp2 = ' + rndp);\n        if (rndp.deg() < 1) {\n            continue;\n        }\n        inlist.forEach(f => {\n            const gcdp = f.gcd(rndp).toMonic();\n            logger.debug('gcdp = ' + gcdp);\n            if (gcdp.deg() < 1 || gcdp.equal(f)) {\n                inlist2.push(f);\n                return;\n            }\n            const tmp = f.divRem(gcdp)[0].toMonic();\n            logger.debug('tmp = ' + tmp);\n            if (gcdp.deg() == deg) {\n                outlist.push(gcdp);\n            } else {\n                inlist2.push(gcdp);\n            }\n            if (tmp.deg() == deg) {\n                outlist.push(tmp);\n            } else {\n                inlist2.push(tmp);\n            }\n        });\n        inlist = inlist2;\n        inlist2 = [];\n    }\n    if (logger.isDebugEnabled()) {\n        logger.debug('out edfcz outlist:');\n        outlist.forEach(f => logger.debug(f.toString()));\n    }\n    return outlist;\n}\n\n/*\n * Factorization on GF(p)\n * freeMP, prime -> array of polynomialMP\n */\nfunction fzfp(freeMP, prime, tinymt) {\n    if (logger.isDebugEnabled()) {\n        logger.debug('in fzfp freeMP = ' + freeMP + ' prime = ' + prime);\n    }\n    if (freeMP.deg() == 1) {\n        if (logger.isDebugEnabled()) {\n            logger.debug('out fzfp irrplist:');\n            logger.debug(freeMP.toString());\n        }\n        return [freeMP];\n    }\n    freeMP = freeMP.toMonic();\n    const one = new PolynomialMP(freeMP.indet, [1], prime);\n    const tee = new PolynomialMP(freeMP.indet, [0, 1], prime);\n    const tp = tee.powerPMod(freeMP);\n    const result = ddf(freeMP, prime, tee, tp);\n    var irrplist = result.map(pair => {\n        if (pair[0].deg() <= pair[1]) {\n            return pair[0];\n        }else {\n            return edfcz(pair[0], pair[1], prime, one, tinymt);\n        }\n    });\n    irrplist = irrplist.flat().sort((a, b) => a.gt(b));\n    if (logger.isDebugEnabled()) {\n        logger.debug('out fzfp irrplist:');\n        irrplist.forEach(el => logger.debug(el.toString()));\n    }\n    return irrplist;\n}\n\n// (a^2 b)^3 c とかだったら?\nfunction fczMP1(poly, prime, tinymt) {\n    const sqf = squareFreeMP(poly);\n    if (logger.isDebugEnabled()) {\n        logger.debug('in fczMP1');\n        logger.debug('prime = ' + prime);\n        logger.debug('poly = ' + poly);\n        logger.debug('sqf[0] = ' + sqf[0]);\n        logger.debug('sqf[1] = ' + sqf[1]);\n        logger.debug('sqf[2] = ' + sqf[2]);\n    }\n    var factors = [];\n    if (sqf[0].deg() > 0) {\n        factors = fczMP1(sqf[0], prime);\n        factors = factors.map(el => [el[0], el[1] * sqf[1]]);\n    }\n    if (logger.isDebugEnabled()) {\n        logger.debug('factors:');\n        factors.forEach(el => {\n            logger.debug(el[0].toString() + ',' + el[1]);\n        });\n    }\n    if (!sqf[2]) {\n        return factors;\n    }\n    var workPol = sqf[2];\n    var tmp = fzfp(workPol, prime, tinymt);\n    tmp = tmp.map(pol => [pol, 1]);\n    factors = factors.concat(tmp);\n    factors = factors.sort((a, b) => a[0].gt(b[0]));\n    if (logger.isDebugEnabled()) {\n        logger.debug('factors:');\n        factors.forEach(el => {\n            logger.debug(el[0].toString() + ',' + el[1]);\n        });\n    }\n    return factors;\n}\n\nfunction selectPrime(lk, least = 2, max = 1000) {\n    const primes = Sosu.getPrimes();\n    var result = 1;\n    for (var i = 0; i < primes.length; i++) {\n        if (primes[i] >= max) {\n            break;\n        }\n        if (lk % primes[i] != 0 && primes[i] >= least) {\n            result = primes[i];\n            break;\n        }\n    }\n    return result; // error\n}\n\n/*\n * 書き直し版 lift\n * 参考：https://mathlog.info/articles/3326\n */\nfunction lift(gb, hb, fb, f, prime, max) {\n    if (logger.isDebugEnabled()) {\n        logger.debug('in lift');\n        logger.debug('gb = ' + gb.toString());\n        logger.debug('hb = ' + hb.toString());\n    }\n    if (gb.isZero() || hb.isZero()) {\n        logger.fatal('gb or hb is zero');\n        //return false;\n    }\n    var p = prime;\n    var n = 1;\n    var tmp = gb.mul(hb);\n    if (!tmp.equal(fb)) {\n        throw new Error('gb * hb != fb');\n    }\n    tmp = gb.exGcd(hb);\n    var a = tmp[0];\n    var b = tmp[1];\n    if (logger.isDebugEnabled()) {\n        logger.debug('a = ' + a.toString());\n        logger.debug('b = ' + b.toString());\n        logger.debug('r = ' + tmp[2].toString());\n    }\n    if (tmp[2].deg() != 0) {\n        // ゆるい条件を満たさない\n        return false;\n    }\n    var gn = gb;\n    var hn = hb;\n    var g0 = gn;\n    var h0 = hn;\n    while (p**n < max) {\n        if (logger.isDebugEnabled()) {\n            logger.debug('n = ' + n);\n            logger.debug('p ** n = ' + (p ** n));\n            logger.debug('max = ' + max);\n        }\n        var nextMod = p**(n+1);\n        var fn = PolynomialMP.fromPolynomial(f, nextMod, p);\n        gn = gn.toNewMod(nextMod);\n        hn = hn.toNewMod(nextMod);\n        fn = fn.toNewMod(nextMod);\n        fn = fn.sub(gn.mul(hn));\n        a = a.toNewMod(nextMod);\n        b = b.toNewMod(nextMod);\n        g0 = g0.toNewMod(nextMod);\n        tmp = fn.mul(b).divRem(g0);\n        var q = tmp[0];\n        var pn = tmp[1];\n        h0 = h0.toNewMod(nextMod);\n        tmp = h0.mul(q);\n        var qn = fn.mul(a).add(h0.mul(q)); // qn.deg <= d - m\n        gn = gn.add(pn);\n        hn = hn.add(qn);\n        n = n + 1;\n    }\n    return gn;\n}\n\nfunction liftFactors(factors, freeMP, free, prime, max) {\n    logger.debug('in lift factors');\n    var result = [];\n    for (var i = 0; i < factors.length; i++) {\n        var fn = factors[i];\n        var gn = freeMP.divRem(fn)[0];\n        if (logger.isDebugEnabled()) {\n            logger.debug('fn = ' + fn);\n            logger.debug('gn = ' + gn);\n        }\n        if (fn.deg() == 0) {\n            // ありえない？ 既約の場合？\n            continue;\n        }\n        var res = lift(fn, gn, freeMP, free, prime, max);\n        logger.debug('lift res = ' + res);\n        if (!res) {\n            continue;\n        }\n        result = uniqPushMonic(result, res);\n    }\n    if (logger.isDebugEnabled()) {\n        logger.debug('out lift factors result:[');\n        result.forEach(x => logger.debug(x.toString()));\n        logger.debug(']');\n    }\n    return result;\n}\n\n/*\n * check and get multiplicity\n */\nfunction checkAndm(pol, orig) {\n    var prime = pol.mod;\n    var lkFactors = Sosu.integerFactorize(orig.leadingK());\n    if (logger.isDebugEnabled()) {\n        logger.debug('in checkAndm');\n        logger.debug('pol = ' + pol.toString());\n        logger.debug('orig = ' + orig.toString());\n        logger.debug('prime = ' + prime);\n        logger.debug('lk = ' + orig.leadingK());\n        logger.debug('lkFactors = [' +\n                     lkFactors.reduce((p, c) => p + c + ',',\n                                      '') + ']');\n    }\n    if (pol.deg() > orig.deg()) {\n        logger.info('pol.deg > orig.deg');\n        return false;\n    }\n    var poly = false;\n    var half = pol.mod / 2;\n    var n = 1;\n    var p2 = false;\n    var mcmb = new MulCMB(lkFactors);\n    var mcmlist = mcmb.getList();\n    for (var i = 0; i < mcmlist.length; i++) {\n        var array = arModToInt(pol.ar, pol.mod, mcmlist[i]);\n        p2 = new Polynomial(pol.indet, array);\n        logger.debug('p2 = ' + p2.toString());\n        var r = orig.divrem(p2);\n        if (r[1].isZero()) {\n            poly = r[0];\n            break;\n        }\n    }\n    if (!poly) {\n        logger.debug('out checkAndm false');\n        return false;\n    }\n    for(;;) {\n        var r = poly.divrem(p2);\n        if (r[1].isZero()) {\n            if (logger.isDebugEnabled()) {\n                Logger.debug('mul poly = ' + poly);\n                logger.debug('p2 = ' + p2);\n                logger.debug('r[0] = ' + r[0])\n                logger.debug('r[1] = ' + r[1])\n            }\n            poly = r[0];\n            n++;\n        } else {\n            break;\n        }\n    }\n    if (logger.isDebugEnabled()) {\n        logger.debug('out checkAndm');\n        logger.debug('p2 = ' + p2.toString() + ' n = ' + n);\n        logger.debug('poly = ' + poly.toString());\n    }\n    return [p2, n, poly];\n}\n\n/*\n * check and get multiplicity for lifted factors.\n * (mod p^n) -> Z\n * 組み合わせを生成する必要がある\n */\nfunction checkFactors(origlifted, origtarget, incomp) {\n    if (origlifted.length == 0) {\n        logger.info('origlifted is empty');\n        return [[],[]];\n    }\n    var targetpol = origtarget;\n    var lifted = origlifted.concat();\n    if (logger.isDebugEnabled()) {\n        logger.debug('in checkFactors lifted:');\n        for (var i = 0; i < lifted.length; i++) {\n            logger.debug(lifted[i].toString());\n        }\n        logger.debug('incomp:');\n        for (var i = 0; i < incomp.length; i++) {\n            logger.debug(incomp[i].toString());\n        }\n    }\n    const one = new PolynomialMP(lifted[0].indet, [1], lifted[0].mod,\n                                 lifted[0].base);\n    var result = [];\n    var doubtfuls = [];\n    while (lifted.length > 0) {\n        if (logger.isDebugEnabled()) {\n            logger.debug('lifted:' +\n                         lifted.reduce((p, c) => p + c + ';', ''));\n        }\n        var liftedcomb = createCombinationGeneratorAll(lifted);\n        var found = false;\n        for (const plar of liftedcomb) {\n            const pol = plar.reduce((p,c) => p.mul(c), one);\n            var r = checkAndm(pol, targetpol);\n            if (logger.isDebugEnabled()) {\n                logger.debug('targetpol = ' + targetpol.toString());\n                logger.debug('pol = ' + pol);\n                if (r) {\n                    logger.debug('r[0] = ' + r[0].toString());\n                    logger.debug('r[1] = ' + r[1]);\n                }\n            }\n            if (!r) {\n                continue;\n            }\n            found = true;\n            targetpol = r[2];\n            if (incomp.some(el => plar.includes(el))) {\n                doubtfuls.push([r[0], r[1]]);\n                logger.debug('doubtfuls push [' + r[0] + ',' + r[1] + ']');\n            } else {\n                result.push([r[0], r[1]]);\n                logger.debug('result push [' + r[0] + ',' + r[1] + ']');\n            }\n            break;\n        }\n        if (targetpol.deg() <= 0) {\n            break;\n        }\n        if (!found) {\n            break;\n        }\n    }\n    if (targetpol.deg() > 0) {\n        doubtfuls.push([targetpol, 1]);\n    }\n    if (logger.isDebugEnabled()) {\n        logger.debug('check Factors result:[');\n        result.forEach(el => logger.debug(el[0].toString() + ',' + el[1]));\n        logger.debug('] doubtfuls:');\n        doubtfuls.forEach(el =>\n                          logger.debug(el[0].toString() + ',' + el[1]));\n        logger.debug(']');\n    }\n    return [result, doubtfuls];\n}\n\n/*\n * Cantor–Zassenhaus algorithm\n * のつもりだが、ちゃんと実装できているか不明。そもそもKZじゃなくてCZではないか。\n*/\nclass KZ {\n    constructor(pol) {\n        this.original = pol;\n        var w = pol.gcdKPX();\n        //this.gcdK = new Polynomial(pol.indet, [w[0]]);\n        this.gcdK = w[0];\n        this.gcdP = w[1];\n        // this.free = this.gcdP.squareFree();\n        this.resultFactors = [];\n        this.tinymt = new TinyMTJS(pol.ar);\n    }\n\n    /*\n     * 因数分解\n     * 分割統治を重視する\n     */\n    factorize() {\n        // 整数の共通因子とx^nをくくり出す\n        var w = this.original.gcdKPX();\n        this.gcdK = w[0];\n        this.gcdP = w[1];\n        const firstFactor = [[this.gcdK, 1]];\n        logger.debug('firstFactor = ' + firstFactor);\n        // var prelist = [];\n\n        const gcdPol = this.gcdP;\n        // this.free = this.gcdP.squareFree();\n        // logger.debug('gcdPol = ' + gcdPol);\n\n        // 括り出しで残りがない場合\n        if (gcdPol.deg() == 0) {\n            // this.resultFactors = firstFactor.concat(prelist);\n            this.resultFactors = firstFactor;\n            this.success = true;\n            return true;\n        }\n        const leastPrime = 3;\n        //var leastPrime = 5;\n        var factors = this.fz0(gcdPol, leastPrime);\n        // factors = factors.concat(prelist);\n        factors = factors.sort((a, b) => a[0].gt(b[0]));\n        factors = reduceFactor(factors);\n        this.resultFactors = firstFactor.concat(factors);\n        this.success = true;\n        return true;\n    }\n\n    /*\n     * square free からやりなおせるように\n     */\n    fz0(pol, leastPrime) {\n        // ここで2乗以上は取り出してしまう\n        const sqfct = pol.squareFactor();\n        if (logger.isDebugEnabled()) {\n            logger.debug('fz0 sqfct:' + sqfct[0] + ',' + sqfct[1]);\n            logger.debug(sqfct[2].toString());\n        }\n        if (pol.leadingK() % sqfct[0].leadingK() != 0) {\n            sqfct[1] = 0;\n            sqfct[2] = pol;\n        }\n        var factors = [];\n        if (sqfct[1] != 0) {\n            factors = this.fz1(sqfct[0]);\n            factors = factors.map(x => [x[0], x[1] * sqfct[1]]);\n        }\n        const free = sqfct[2];\n        factors = factors.concat(this.fz1(free, leastPrime));\n        factors = factors.filter(el => el[0].deg() >= 1);\n        if (logger.isDebugEnabled()) {\n            logger.debug('out fz0 factors:');\n            for (var i = 0; i < factors.length; i++) {\n                logger.debug(factors[i].toString());\n            }\n        }\n        return factors;\n    }\n\n    // gcd いらない free と同じ\n    fz1(free, leastPrime) {\n        // logger.debug('in fz1 free = ' + free);\n        // logger.debug('gcd = ' + gcd);\n        // if (gcd.deg() <= 1) {\n        //     return [[gcd, 1]];\n        // }\n        if (free.deg() <= 1) {\n            // const r = checkList2([free], gcd);\n            // return r[0];\n            return [[free, 1]];\n        }\n        const lk = free.leadingK();\n        var prime = selectPrime(lk, leastPrime);\n        if (prime > 100) {\n            throw new Error('select prime fail');\n        }\n        var factors = this.fz2(free, prime);\n        return factors;\n    }\n\n    /*\n      free, prime -> factors\n     */\n    fz2(free, prime) {\n        if (logger.isDebugEnabled()) {\n            logger.debug('in fz2 free = ' + free);\n            logger.debug('prime = ' + prime);\n        }\n        // var freedeg = free.deg();\n        const max = free.maxK() * 2;\n        // const lk = free.leadingK();\n        var freeMP = PolynomialMP.fromPolynomial(free, prime);\n\n        // ここでMPのsquareFactorを使う\n        logger.debug('freeMP = ' + freeMP);\n        const sqf = freeMP.squareFactor();\n        var sq = sqf[0];\n        var mul = sqf[1];\n        const rem = sqf[2];\n        // if (logger.isDebugEnabled()) {\n        //     logger.debug('sq = ' + sq);\n        //     logger.debug('mul = ' + mul);\n        //     logger.debug('rem = ' + rem);\n        // }\n        if (mul == 1) {\n            const sqf2 = freeMP.squareFactor();\n            var sq = sqf2[0];\n            var mul = sqf2[1];\n        }\n        if (logger.isDebugEnabled()) {\n            logger.debug('sq = ' + sq);\n            logger.debug('mul = ' + mul);\n            logger.debug('rem = ' + rem);\n        }\n        var sqfactors = [sq.power(mul)];\n        //var factors = this.kz(rem, prime).sort((a, b) => a.gt(b))\n        var factors = fzfp(rem, prime, this.tinymt).sort((a, b) => a.gt(b))\n        if (logger.isDebugEnabled()) {\n            logger.debug('fz2 sqfactors:');\n            for (var i = 0; i < sqfactors.length; i++) {\n                logger.debug(sqfactors[i].toString());\n            }\n            logger.debug('fz2 factors:');\n            for (var i = 0; i < factors.length; i++) {\n                logger.debug(factors[i].toString());\n            }\n        }\n        var sqlifted = liftFactors(sqfactors, freeMP, free, prime, max);\n        var lifted = liftFactors(factors, freeMP, free, prime, max);\n        if (logger.isDebugEnabled()) {\n            logger.debug('fz2 sqlifted:');\n            for (var i = 0; i < sqlifted.length; i++) {\n                logger.debug(sqlifted[i].toString());\n            }\n            logger.debug('fz2 lifted:');\n            for (var i = 0; i < lifted.length; i++) {\n                logger.debug(lifted[i].toString());\n            }\n        }\n        if (sqlifted.length == 0 && lifted.length == 0) {\n            prime = selectPrime(free.leadingK(), prime + 1);\n            return this.fz2(free, prime);\n        }\n        lifted = lifted.concat(sqlifted).sort((a, b) => a.gt(b));\n        const res = checkFactors(lifted, free, sqlifted)\n        var intfactors = res[0];\n        const doubtfuls = res[1];\n        if (logger.isDebugEnabled()) {\n            logger.debug('intfactors2:');\n            intfactors.forEach(el =>\n                            logger.debug(el[0].toString() + \",\" + el[1] + ';'));\n            logger.debug('doubtfuls:');\n            doubtfuls.forEach (el =>\n                               logger.debug(el[0].toString() + \",\" + el[1] + ';'));\n        }\n        if (doubtfuls.length == 0) {\n            // console.log('intfactors3:' + JSON.stringify(intfactors));\n            return intfactors;\n        }\n        var leastPrime = 3;\n        if (intfactors.length == 0) {\n            leastPrime = prime + 1;\n        }\n        // console.log('doubtfuls:' + JSON.stringify(doubtfuls));\n        doubtfuls.forEach(db => {\n            // console.log('db:' + JSON.stringify(db));\n            prime = selectPrime(db[0].leadingK(), leastPrime);\n            /* istanbul ignore if */\n            if (prime > 100) {\n                logger.fatal('prime > 100, prime = ' + prime);\n                intfactors.push(db);\n            } else {\n                // const fc = this.fz2(db[0], prime);\n                const fc = this.fz0(db[0], prime);\n                // console.log('fc:' + JSON.stringify(fc));\n                intfactors = intfactors.concat(fc.map(x => [x[0], x[1] * db[1]]));\n            }\n        });\n        // console.log('intfactors4:' + JSON.stringify(intfactors));\n        return intfactors.filter(x => x[0].deg() > 0);\n    }\n\n    getFactors() {\n        return this.resultFactors;\n    }\n\n    getStringFactors(desc = true) {\n        var s = '';\n        var kxn = this.resultFactors[0][0];\n        var k = kxn.leadingK();\n        var deg = kxn.deg();\n        if (k != 1 || deg > 0) {\n            s = s + kxn.toString();\n        } else if (this.resultFactors.length == 2 &&\n                   this.resultFactors[1][1] == 1) {\n            return this.resultFactors[1][0].toString(desc);\n        }\n        for (var i = 1; i < this.resultFactors.length; i++) {\n            var el = this.resultFactors[i];\n            s = s + '(' + el[0].toString(desc) + ')';\n            if (el[1] != 1) {\n                s = s + '^' + el[1];\n            }\n        }\n        return s;\n    }\n\n    // (a^2 b)^3 c とかだったら?\n    static factorizeModP(poly) {\n        if (!(poly instanceof PolynomialMP)) {\n            throw new Error('poly is not PolynomialMP');\n        }\n        const prime = poly.base;\n        const seed = poly.ar.concat();\n        seed.push(prime);\n        const tinymt = new TinyMTJS(seed);\n\n        // const orig = PolynomialMP.fromPolynomial(this.original, prime);\n        const orig = poly;\n\n        const lk = orig.leadingK();\n        var workPol = orig.toMonic();\n        var xn = workPol.getXn();\n        var preList = [[xn[0].mulK(lk), 1]];\n        workPol = xn[1];\n        logger.debug('preList = ' + preList);\n        if (workPol.deg() <= 0) {\n            return preList;\n        }\n        var factor = fczMP1(workPol, prime, tinymt);\n        factor = reduceFactor(factor);\n        return preList.concat(factor);\n    }\n\n    static factorToString(factors, desc=true) {\n        logger.debug('in factorToString desc = ' + desc);\n        var s = '';\n        var kxn = factors[0][0];\n        var k = kxn.leadingK();\n        var deg = kxn.deg();\n        if (k != 1 || deg > 0) {\n            s = s + kxn.toString(desc, false);\n        } else if (factors.length == 2 &&\n                   factors[1][1] == 1) {\n            return factors[1][0].toString(desc, false);\n        }\n        for (var i = 1; i < factors.length; i++) {\n            var el = factors[i];\n            s = s + '(' + el[0].toString(desc, false) + ')';\n            if (el[1] != 1) {\n                s = s + '^' + el[1];\n            }\n        }\n        return s;\n    }\n\n}\n\nexports.KZ = KZ;\n","class Log4JSDummyLogger {\n    costructor() {\n        this.level = '';\n    }\n    debug() {};\n    isDebugEnabled() {return false};\n    fatal() {};\n    error() {};\n    warn() {};\n    info() {};\n    debug() {};\n    trace() {};\n}\n\nfunction getLogger() {\n    return new Log4JSDummyLogger();\n}\n\nexports.getLogger = getLogger;\n","//require('./euclid');\nconst euclid = require('./euclid');\n//const longmd = require('./longnum');\nconst gcdInt = euclid.gcdInt;\nconst lcmInt = euclid.lcmInt;\nconst exgcd = euclid.exgcd;\nconst inverse = euclid.inverse;\n//const LongNum = longmd.LongNum;\n\nconst log4js = require('./log4js')\nconst logger = log4js.getLogger();\n// fatal\n// error\n// warn\n// info\n// debug\n// trace\n//logger.level = 'debug';\nlogger.level = 'fatal';\n\nfunction arDeg(ar) {\n    for (var i = ar.length -1; i >= 0; i--) {\n        if (ar[i] != 0) {\n            return i;\n        }\n    }\n    return -1;\n}\n\nfunction arEqual(ar1, ar2) {\n    const deg1 = arDeg(ar1);\n    const deg2 = arDeg(ar2);\n    if (deg1 != deg2) {\n        return false;\n    }\n    if (deg1 == -1) {\n        return true;\n    }\n    for (var i = 0; i <= deg1; i++) {\n        if (ar1[i] != ar2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction arToString(indet, ar) {\n    const deg = arDeg(ar);\n    if (deg == -1) {\n        return '0';\n    }\n    var s = '';\n    var sep = '';\n    for (var i = 0; i <= deg; i++) {\n        if (ar[i] != 0) {\n            if (i != 0 && ar[i] == 1) {\n                s = s + sep;\n            } else if (i != 0 && ar[i] == -1) {\n                s = s + '-';\n            } else if (ar[i] < 0) {\n                s = s + ar[i];\n            } else {\n                s = s + sep + ar[i];\n            }\n            sep = '+';\n            if (i == 0) {\n                continue;\n            }\n            s = s + indet;\n            if (i == 1) {\n                continue;\n            }\n            s = s + '^' + i.toString();\n        }\n    }\n    return s;\n}\n\nfunction arToDescString(indet, ar) {\n    const deg = arDeg(ar);\n    if (deg == -1) {\n        return '0';\n    }\n    var s = '';\n    var sep = '';\n    for (var i = deg; i >= 0; i--) {\n        if (ar[i] != 0) {\n            if (i != 0 && ar[i] == 1) {\n                s = s + sep;\n            } else if (i != 0 && ar[i] == -1) {\n                s = s + '-';\n            } else if (ar[i] < 0) {\n                s = s + ar[i];\n            } else {\n                s = s + sep + ar[i];\n            }\n            sep = '+';\n            if (i == 0) {\n                continue;\n            }\n            s = s + indet;\n            if (i == 1) {\n                continue;\n            }\n            s = s + '^' + i.toString();\n        }\n    }\n    return s;\n}\n\nfunction arPowerP(ar, p) {\n    var array = new Array(ar.length * p).fill(0);\n    for (let i = 0; i < ar.length; i++) {\n        array[i*p] = ar[i];\n    }\n    return arShorten(array);\n}\n\nfunction arStandard(ar, mod) {\n    for (var i = 0; i < ar.length; i++) {\n        ar[i] = ((ar[i] % mod) + mod) % mod;\n    }\n}\n\nfunction arLeadingK(ar) {\n    for (var i = ar.length -1; i >= 0; i--) {\n        if (ar[i] != 0) {\n            return ar[i];\n        }\n    }\n    return -1;\n}\n\nfunction arXn(ar) {\n    for (var i = 0; i < ar.length; i++) {\n        if (ar[i] != 0) {\n            return i;\n        }\n    }\n    return -1;\n}\n\nfunction arMaxK(ar) {\n    var max = Math.abs(ar[0]);\n    for (var i = 1; i < ar.length; i++) {\n        if (Math.abs(ar[i]) > max) {\n            max = Math.abs(ar[i]);\n        }\n    }\n    return max;\n}\n\nfunction arAdd(ar1, ar2) {\n    const deg1 = arDeg(ar1);\n    const deg2 = arDeg(ar2);\n    var res;\n    var b;\n    var d;\n    if (deg1 >= deg2) {\n        d = deg2;\n        res = ar1.concat();\n        b = ar2;\n    } else {\n        d = deg1;\n        res = ar2.concat();\n        b = ar1;\n    }\n    for (var i = 0; i <= d; i++) {\n        res[i] = res[i] + b[i];\n    }\n    return res;\n}\n\nfunction arGt(ar1, ar2) {\n    var deg1 = arDeg(ar1);\n    var deg2 = arDeg(ar2);\n    if (deg1 > deg2) {\n        return 1;\n    } else if (deg1 < deg2) {\n        return -1;\n    }\n    for (var i = deg1; i >= 0; i--) {\n        if (ar1[i] == ar2[i]) {\n            continue;\n        }\n        if (ar1[i] == 0 && ar2[i] != 0) {\n            return -1;\n        }\n        if (ar2[i] == 0 && ar1[i] != 0) {\n            return 1;\n        }\n        if (ar1[i] < 0 && ar2[i] > 0) {\n            return -1;\n        }\n        if (ar2[i] < 0 && ar1[i] > 0) {\n            return 1;\n        }\n        return Math.abs(ar1[i]) - Math.abs(ar2[i]);\n    }\n    return 0;\n}\n\n/*\n * deg(ar1) >= deg(ar2) + shift と仮定する\n * ar2 の 要素に k を掛けて index の大きい方に shift して ar1 に加える\n * ar1 は破壊的に変化する。\n */\nfunction arAddMulShift(ar1, ar2, k, shift) {\n    const deg1 = arDeg(ar1);\n    const deg2 = arDeg(ar2);\n    if (ar1.length < deg2 + shift + 1) {\n        throw new Error('invalid degree');\n    }\n    for (var i = 0; i <= deg2; i++) {\n        ar1[i+shift] = ar1[i+shift] + k * ar2[i];\n    }\n}\n\nfunction arSub(ar1, ar2) {\n    const deg1 = arDeg(ar1);\n    const deg2 = arDeg(ar2);\n    var res;\n    var b;\n    var d;\n    var s;\n    if (deg1 >= deg2) {\n        d = deg2;\n        res = ar1.concat();\n        s = -1;\n        b = ar2;\n    } else {\n        d = deg1;\n        res = ar2.concat();\n        s = 1;\n        b = ar1;\n        for (var i = 0; i < res.length; i++) {\n            res[i] = -res[i];\n        }\n    }\n    for (var i = 0; i <= d; i++) {\n        res[i] = res[i] + s * b[i];\n    }\n    return res;\n}\n\nfunction arMulK(ar, k) {\n    var res = ar.concat();\n    for (var i = 0; i < res.length; i++) {\n        res[i] = res[i] * k;\n    }\n    return res;\n}\n\nfunction arDivK(ar, k) {\n    var res = ar.concat();\n    for (var i = 0; i < res.length; i++) {\n        res[i] = res[i] / k;\n    }\n    return res;\n}\n\nfunction arGcdK(ar) {\n    var d = arDeg(ar);\n    if (d == -1) {\n        return 0;\n    }\n    var a = ar[d];\n    if (Math.abs(a) == 1) {\n        return a;\n    }\n    for (var i = 0; i < d; i++) {\n        if (ar[i] == 0) {\n            continue;\n        }\n        if (Math.abs(ar[i]) == 1) {\n            return Math.sign(ar[d]);\n        }\n        a = gcdInt(a, ar[i]);\n    }\n    return Math.sign(ar[d]) * Math.abs(a);\n}\n\nfunction arRandom(deg, max) {\n    var ar = new Array(deg + 1);\n    for (var i = 0; i <= deg; i++) {\n        var r = Math.trunc(Math.random() * max);\n        var sign = 1 - Math.trunc(Math.random() * 2) * 2;\n        ar[i] = sign * r;\n    }\n    while(ar[deg] == 0) {\n        ar[deg] = Math.trunc(Math.random() * max);\n    }\n    return ar;\n}\n\nfunction arIsTanko(ar) {\n    var deg = arDeg(ar);\n    for (var i = deg -1; i >= 0; i--) {\n        if (ar[i] != 0) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction arShorten(ar) {\n    if (ar[ar.length -1] != 0) {\n        return ar;\n    }\n    res = ar.concat();\n    while (res[res.length-1] == 0) {\n        res.pop();\n    }\n    return res;\n}\n\n// function dzerofactor(pol, prime) {\n//     var ar1 = pol.ar;\n//     var ar2 = [];\n//     var finish = false;\n//     var cnt = 0;\n//     while (!finish) {\n//         for (let i = 0; i < ar1.length; i++) {\n//             if (i % prime == 0) {\n//                 ar2.push(ar1[i]);\n//             } else if (ar1[i] != 0) {\n//                 finish = true;\n//                 break;\n//             }\n//         }\n//         if (finish) {\n//             break;\n//         }\n//         ar1 = ar2;\n//         ar2 = [];\n//         cnt += prime;\n//     }\n//     return [new PolynomialMP(pol.indet, arShorten(ar1), pol.mod, pol.base),\n//             cnt,\n//             new PolynomialMP(pol.indet, [1], pol.mod, pol.base)];\n// }\n\n/*\n * 多項式のクラス\n */\nclass Polynomial {\n    constructor(str, ar) {\n        this.indet = str;\n        this.ar = ar.concat();\n    }\n    static fromString(str) {\n        var sar = str.split(/[:,]/);\n        const indet = sar[0];\n        const ar = new Array(sar.length -1);\n        for (var i = 1; i < sar.length; i++) {\n            ar[i - 1] = parseInt(sar[i]);\n        }\n        return new Polynomial(indet, ar);\n    }\n    static fromString2(str) {\n        const indet = str.replaceAll(/[0-9+^-]/g, \"\")[0];\n        const star = str.replaceAll(/[-]/g, \"+-\").split(/\\+/);\n        var result = new Polynomial(indet, [0]);\n        star.forEach(el => {\n            var s = el;\n            var res = s.match(/^-?[0-9]+/);\n            var k = 1;\n            var deg = 0;\n            if (res) {\n                k = parseInt(res[0], 10);\n                s = s.replace(/^-?[0-9]+/, \"\");\n            }\n            if (s.match(/^[A-Za-z]/)) {\n                deg = 1;\n                s = s.replace(/^[A-Za-z]+/, \"\");\n            }\n            s = s.replace(/\\^/, \"\");\n            if (s.match(/[0-9]+/)) {\n                deg = parseInt(s, 10);\n            }\n            const ar = new Array(deg+1).fill(0);\n            ar[deg] = k;\n            const term = new Polynomial(indet, ar);\n            result = result.add(term);\n        });\n        return result;\n    }\n    deg() {\n        return arDeg(this.ar);\n    }\n    isTanko() {\n        return arIsTanko(this.ar);\n    }\n    equal(pol) {\n        if (this.indet != pol.indet) {\n            return false;\n        }\n        return arEqual(this.ar, pol.ar);\n    }\n    isZero() {\n        return this.deg() == -1;\n    }\n    leadingK() {\n        return arLeadingK(this.ar);\n    }\n    tailingK() {\n        return this.ar[0];\n    }\n    toString(desc = false) {\n        if (desc) {\n            return this.toDescString();\n        } else {\n            return arToString(this.indet, this.ar, this.deg());\n        }\n    }\n    toDescString() {\n        return arToDescString(this.indet, this.ar, this.deg());\n    }\n    /*\n     * return this * kx^n\n     */\n    kmulxn(k, n) {\n        const ar = new Array(this.deg()+n+1);\n        for (var i = 0; i <= this.deg(); i++) {\n            ar[i + n] = this.ar[i] * k;\n        }\n        for (var i = 0; i < n; i++) {\n            ar[i] = 0;\n        }\n        return new Polynomial(this.indet, ar);\n    }\n    add(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        const res = arAdd(this.ar, pol.ar);\n        return new Polynomial(this.indet, res);\n    }\n    sub(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        const res = arSub(this.ar, pol.ar);\n        return new Polynomial(this.indet, res);\n    }\n    gt(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        return arGt(this.ar, pol.ar);\n    }\n    mul(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        if (this.isZero() || pol.isZero()) {\n            return new Polynomial(this.indet, [0]);\n        }\n        var pdeg = pol.deg();\n        var ar = new Array(this.deg() + pdeg + 1).fill(0);\n        for (var i = 0; i <= pdeg; i++) {\n            var k = pol.ar[i];\n            if (k != 0) {\n                arAddMulShift(ar, this.ar, k, i);\n            }\n        }\n        return new Polynomial(this.indet, ar);\n    }\n    maxK() {\n        return arMaxK(this.ar);\n    }\n    /*\n     * gcd of coefficients\n     */\n    gcdK() {\n        // var d = this.deg();\n        // if (d == -1) {\n        //     return 0;\n        // }\n        return arGcdK(this.ar);\n        // var a = this.ar[d];\n        // if (Math.abs(a) == 1) {\n        //     return a;\n        // }\n        // for (var i = 0; i < d; i++) {\n        //     if (this.ar[i] == 0) {\n        //         continue;\n        //     }\n        //     if (Math.abs(this.ar[i]) == 1) {\n        //         return Math.sign(this.ar[d]);\n        //     }\n        //     a = gcdInt(a, this.ar[i]);\n        // }\n        // return Math.sign(this.ar[d]) * Math.abs(a);\n    }\n    /*\n     * 係数の gcd をくくり出し、それで割った多項式と共に返す\n     */\n    gcdKP() {\n        const a = this.gcdK();\n        const ar = this.ar.concat();\n        for (var i = 0; i <= this.deg(); i++) {\n            ar[i] = ar[i] / a;\n        }\n        return [a, new Polynomial(this.indet, ar)];\n    }\n    gcdKPX() {\n        const a = this.gcdK();\n        var n = 0;\n        for (var i = 0; i <= this.deg(); i++) {\n            if (this.ar[i] != 0) {\n                n = i;\n                break;\n            }\n        }\n        var xar = new Array(n + 1).fill(0);\n        // console.log('n = ' + n);\n        xar[n] = a;\n        // console.log(xar);\n        var r1 = new Polynomial(this.indet, xar);\n        var r2 = this.divrem(r1)[0];\n        return [r1, r2];\n    }\n    /*\n     * differential 多項式の微分\n     */\n    d() {\n        var d = this.deg();\n        if (d <= 0) {\n            return new Polynomial(this.indet, [0]);\n        }\n        var ar = new Array(d);\n        for (var i = 1; i <= d; i++) {\n            ar[i - 1] = this.ar[i] * i;\n        }\n        return new Polynomial(this.indet, ar);\n    }\n    modK(mod) {\n        if (mod <= 1) {\n            throw new Error('zero divide');\n        }\n        var ar = this.ar.concat();\n        arStandard(ar, mod);\n        return new Polynomial(this.indet, ar);\n    }\n    /*\n     * 余り付き割り算\n     * return [p, r], where p*pol + r = this\n     */\n    divrem(pol) {\n        if (this.indet != pol.indet) {\n            logger.fatal('this.indet = ' + this.indet);\n            logger.fatal('pol.indet = ' + pol.indet);\n            throw new Error('indetermint mismatch');\n        }\n        if (pol.isZero()) {\n            throw new Error('zero divide');\n        }\n        if (this.deg() < pol.deg()) {\n            return [new Polynomial(this.indet, [0]),\n                    new Polynomial(this.indet, this.ar)];\n        }\n        var tl = arLeadingK(this.ar);\n        var pl = arLeadingK(pol.ar);\n        if (tl % pl != 0) {\n            return [new Polynomial(this.indet, [0]),\n                    new Polynomial(this.indet, this.ar)];\n        }\n        var diff = this.deg() - pol.deg();\n        const ar = new Array(diff+1).fill(0);\n        ar[diff] = tl / pl;\n        // for (var i = 0; i < diff; i++) {\n        //     ar[i] = 0;\n        // }\n        var tmp = this.sub(pol.kmulxn(tl/pl, diff));\n        while (diff > 0) {\n            diff = tmp.deg() - pol.deg();\n            tl = tmp.leadingK();\n            if (tl % pl != 0 || diff < 0) {\n                return [new Polynomial(this.indet, ar), tmp];\n            }\n            ar[diff] = tl / pl;\n            tmp = tmp.sub(pol.kmulxn(tl/pl, diff));\n        }\n        return [new Polynomial(this.indet, ar), tmp];\n    }\n    /*\n     * 余り付き割り算（インチキ）\n     * return [p, r], where p*pol + r = this\n     */\n    remX(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        if (pol.isZero()) {\n            throw new Error('zero divide');\n        }\n        if (this.deg() < pol.deg()) {\n            return new Polynomial(this.indet, this.ar);\n        }\n        var tl = this.leadingK();\n        var pl = pol.leadingK();\n        // if (tl % pl != 0) {\n        //     return [new Polynomial(this.indet, [0]),\n        //             new Polynomial(this.indet, this.ar)];\n        // }\n        var diff = this.deg() - pol.deg();\n        const ar = new Array(diff+1).fill(0);\n        var tmp = new Polynomial(this.indet, this.ar);\n        if (tl % pl != 0) {\n            const m = lcmInt(tl, pl) / tl;\n            tl = tl * m;\n            tmp = tmp.kmulxn(m, 0);\n        }\n        ar[diff] = tl / pl;\n        tmp = tmp.sub(pol.kmulxn(tl/pl, diff));\n        while (diff > 0 && !tmp.isZero()) {\n            diff = tmp.deg() - pol.deg();\n            if (diff < 0) {\n                break;\n            }\n            tl = tmp.leadingK();\n            if (tl % pl != 0) {\n//                return [new Polynomial(this.indet, ar), tmp];\n                const m = lcmInt(tl, pl) / tl;\n                tl = tl * m;\n                tmp = tmp.kmulxn(m, 0);\n            }\n            ar[diff] = tl / pl;\n            tmp = tmp.sub(pol.kmulxn(tl/pl, diff));\n        }\n        const kp = tmp.gcdKP();\n        return kp[1];\n    }\n    /*\n     * 余り付き割り算（float係数）\n     * return [p, r], where p*pol + r = this\n     */\n    remY(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        if (pol.isZero()) {\n            throw new Error('zero divide');\n        }\n        if (this.deg() < pol.deg()) {\n            return new Polynomial(this.indet, this.ar);\n        }\n        var tl = this.leadingK();\n        var pl = pol.leadingK();\n        var diff = this.deg() - pol.deg();\n        const ar = new Array(diff+1).fill(0);\n        var tmp = new Polynomial(this.indet, this.ar);\n        ar[diff] = tl / pl;\n        tmp = tmp.sub(pol.kmulxn(tl/pl, diff));\n        while (diff > 0 && !tmp.isZero()) {\n            diff = tmp.deg() - pol.deg();\n            if (diff < 0) {\n                break;\n            }\n            tl = tmp.leadingK();\n            ar[diff] = tl / pl;\n            tmp = tmp.sub(pol.kmulxn(tl/pl, diff));\n        }\n        // return tmp.toIntK();\n        return tmp;\n    }\n    gcd(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        var a = this;\n        var b = pol;\n        var t = this.gcdKP();\n        var ak = t[0];\n        a = t[1];\n        t = pol.gcdKP();\n        var bk = t[0]\n        b = t[1];\n        var gcdK = gcdInt(ak, bk);\n        if (b.deg() > a.deg()) {\n            return b.gcd(a);\n        }\n        if (b.deg() == a.deg() && b.leadingK() > a.leadingK()) {\n            return b.gcd(a);\n        }\n        while (!b.isZero()) {\n            var t = b;\n            var tmp = a.divrem(b);\n            b = tmp[1];\n            if (b.deg() >= a.deg()) {\n                return new Polynomial(this.indet, [gcdK]);\n            }\n            a = t;\n        }\n        if (a.deg() == 0 && a.leadingK() == -1) {\n            return new Polynomial(this.indet, [1]);\n        } else {\n            return a.kmulxn(gcdK, 0);\n        }\n    }\n    gcdX(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        var a = this;\n        var b = pol;\n        // console.log('a = ' + a.toString());\n        // console.log('b = ' + b.toString());\n        var t = this.gcdKP();\n        var ak = t[0];\n        a = t[1];\n        t = pol.gcdKP();\n        var bk = t[0]\n        b = t[1];\n        var gcdK = gcdInt(ak, bk);\n        if (b.deg() > a.deg()) {\n            return b.gcdX(a);\n        }\n        if (b.deg() == a.deg() && b.leadingK() > a.leadingK()) {\n            return b.gcdX(a);\n        }\n        while (!b.isZero()) {\n            // console.log('a = ' + a.toString());\n            // console.log('b = ' + b.toString());\n            var t = b;\n            //var tmp = a.divrem(b);\n            b = a.remX(b);\n            // if (b.deg() >= a.deg()) {\n            //     return new Polynomial(this.indet, [gcdK]);\n            // }\n            a = t;\n            // console.log('gcdx a = ' + a.toString());\n            // console.log('gcdx b = ' + b.toString());\n        }\n        // console.log('a = ' + a.toString());\n        // console.log('b = ' + b.toString());\n        // console.log('gcdK = ' + gcdK);\n        // remXではgcdを括り出しているので-1にならない\n//        if (a.deg() == 0 && a.leadingK() == -1) {\n        if (a.deg() == 0) {\n            return new Polynomial(this.indet, [1]);\n        } else {\n            return a.kmulxn(gcdK, 0);\n        }\n    }\n    gcdY(pol) {\n        if (this.indet != pol.indet) {\n            throw new Error('indetermint mismatch');\n        }\n        if (pol.deg() > this.deg()) {\n            return pol.gcdY(this);\n        }\n        var a = this.gcdKP()[1];\n        // console.log('pol = ' + pol);\n        // console.log('gcd = ' + JSON.stringify(pol.gcdKP()))\n        var b = pol.gcdKP()[1];\n        // console.log('b = ' + b);\n        b = b.kmulxn(1/b.leadingK(), 0); // float\n        // console.log('a = ' + a.toString());\n        // console.log('b = ' + b.toString());\n        while (!b.isZero()) {\n            console.log('a = ' + a.toString());\n            console.log('b = ' + b.toString());\n            var t = b;\n            //var tmp = a.divrem(b);\n            b = a.remY(b);\n            // if (b.deg() >= a.deg()) {\n            //     return new Polynomial(this.indet, [gcdK]);\n            // }\n            a = t;\n            // console.log('gcdx a = ' + a.toString());\n            // console.log('gcdx b = ' + b.toString());\n        }\n\n\n\n        // console.log('a = ' + a.toString());\n        // console.log('b = ' + b.toString());\n        // console.log('gcdK = ' + gcdK);\n        // remXではgcdを括り出しているので-1にならない\n//        if (a.deg() == 0 && a.leadingK() == -1) {\n        if (a.deg() == 0) {\n            return new Polynomial(this.indet, [1]);\n        } else {\n            // return a.kmulxn(gcdK, 0);\n            return a;\n        }\n    }\n    squareFree() {\n        var d = this.d().gcdKP()[1];\n//        var g = this.gcd(d);\n        var g = this.gcdX(d);\n        if (g.deg() > 0) {\n            var t = this.divrem(g);\n            if (!t[0].isZero()) {\n                return t[0];\n            } else {\n                var t = this.gcdKP()[1];\n                return new Polynomial(t.indet, t.ar);\n            }\n        } else {\n            var t = this.gcdKP()[1];\n            return new Polynomial(t.indet, t.ar);\n        }\n    }\n    /*\n     * 2乗以上の因子と残りに分けて返す\n     */\n    squareFactor() {\n        var d = this.d().gcdKP()[1];\n        var g = this.gcdX(d);\n        if (g.deg() <= 0) {\n            return [g, 0, new Polynomial(this.indet, this.ar)];\n        }\n        var t = this.divrem(g);\n        g = g.gcdX(t[0]);\n        var q = this.divrem(g)[0];\n        var n = 1;\n        while(q.deg() > 0) {\n            t = q.divrem(g);\n            var r = t[1];\n            if (!r.isZero()) {\n                return [g, n, q];\n            }\n            q = t[0];\n            n++;\n        }\n        return [g, n, q];\n    }\n    static getRandom(indet, deg, max) {\n        deg = Math.trunc(deg);\n        max = Math.trunc(max);\n        if (deg < 1) {\n            throw new Error('deg too small');\n        }\n        if (max < 2) {\n            throw new Error('max too small');\n        }\n        var array = arRandom(deg, max);\n        return new Polynomial(indet, array);\n    }\n}\n\nclass PolynomialMP {\n    constructor(indet, ar, mod, base = mod) {\n        this.indet = indet;\n        this.ar = ar.concat();\n        this.mod = mod;\n        this.base = base;\n        this.standard();\n    }\n    static fromPolynomial(pol, mod, base = mod) {\n        return new PolynomialMP(pol.indet, pol.ar, mod, base);\n    }\n    static fromString2(str, prime) {\n        const indet = str.replaceAll(/[0-9+^-]/g, \"\")[0];\n        const star = str.replaceAll(/[-]/g, \"+-\").split(/\\+/);\n        var result = new PolynomialMP(indet, [0], prime);\n        star.forEach(el => {\n            var s = el;\n            var res = s.match(/^-?[0-9]+/);\n            var k = 1;\n            var deg = 0;\n            if (res) {\n                k = parseInt(res[0], 10);\n                s = s.replace(/^-?[0-9]+/, \"\");\n            }\n            if (s.match(/^[A-Za-z]/)) {\n                deg = 1;\n                s = s.replace(/^[A-Za-z]+/, \"\");\n            }\n            s = s.replace(/\\^/, \"\");\n            if (s.match(/[0-9]+/)) {\n                deg = parseInt(s, 10);\n            }\n            const ar = new Array(deg+1).fill(0);\n            ar[deg] = k;\n            const term = new PolynomialMP(indet, ar, prime);\n            result = result.add(term);\n        });\n        return result;\n    }\n    toPolynomial() {\n        return new Polynomial(this.indet, this.ar);\n    }\n    equal(pol) {\n        if (this.indet != pol.indet) {\n            return false;\n        }\n        if (this.mod != pol.mod) {\n            return false;\n        }\n        return arEqual(this.ar, pol.ar);\n    }\n    toNewMod(mod) {\n        if (mod % this.base != 0) {\n            logger.fatal('invalid mod, mod = ' + mod + ' base = ' + this.base);\n            throw new Error('invalid mod');\n        }\n        return new PolynomialMP(this.indet, this.ar, mod, this.base);\n    }\n    getMod() {\n        return this.mod;\n    }\n    standard() {\n        arStandard(this.ar, this.mod);\n    }\n    toString(desc = false, dispmod = true) {\n        if (dispmod) {\n            if (desc) {\n                return arToDescString(this.indet, this.ar, this.deg())+\n                    '(' + this.mod + ')';\n            } else {\n                return arToString(this.indet, this.ar, this.deg())+\n                    '(' + this.mod + ')';\n            }\n        } else {\n            if (desc) {\n                return arToDescString(this.indet, this.ar, this.deg());\n            } else {\n                return arToString(this.indet, this.ar, this.deg());\n            }\n        }\n    }\n    deg() {\n        return arDeg(this.ar);\n    }\n    isZero() {\n        return this.deg() == -1;\n    }\n    leadingK() {\n        return arLeadingK(this.ar);\n    }\n    add(pol) {\n        if (this.indet != pol.indet || this.mod != pol.mod) {\n            throw new Error('indetermint mismatch');\n        }\n        const res = arAdd(this.ar, pol.ar);\n        return new PolynomialMP(this.indet, res, this.mod, this.base);\n    }\n    sub(pol) {\n        if (this.indet != pol.indet || this.mod != pol.mod) {\n            throw new Error('indetermint mismatch');\n        }\n        const res = arSub(this.ar, pol.ar);\n        return new PolynomialMP(this.indet, res, this.mod, this.base);\n    }\n    mulK(k) {\n        const res = arMulK(this.ar, k);\n        return new PolynomialMP(this.indet, res, this.mod, this.base);\n    }\n    divK(k) {\n        const res = arDivK(this.ar, k);\n        return new PolynomialMP(this.indet, res, this.mod, this.base);\n    }\n    /*\n     * differential 多項式の微分\n     */\n    d() {\n        var d = this.deg();\n        if (d <= 0) {\n            return new PolynomialMP(this.indet, [0], this.mod, this.base);\n        }\n        var ar = new Array(d).fill(0);\n        for (var i = 1; i <= d; i++) {\n            ar[i - 1] = this.ar[i] * i;\n        }\n        return new PolynomialMP(this.indet, ar, this.mod, this.base);\n    }\n    hasSquare() {\n        var d = this.d();\n        var g = this.gcd(d);\n        if (g.deg() > 0) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n    squareFree() {\n        var d = this.d();\n        if (d.isZero()) {\n            // return dzerofactor(this, this.mod)[0];\n            return new PolynomialMP(this.indet, this.ar, this.mod);\n        }\n        var g = this.gcd(d);\n        if (g.deg() > 0) {\n            var t = this.divRem(g);\n            return t[0].toMonic();\n        } else {\n            return this.toMonic();\n        }\n    }\n\n    /*\n     * 2乗以上の因子と残りに分けて返す\n     */\n    squareFactor() {\n        var xnpr = this.getXn();\n        var xn = xnpr[0];\n        var xnrem = xnpr[1];\n        var d = xnrem.d();\n        if (logger.isDebugEnabled()) {\n            logger.debug('xn = ' + xn);\n            logger.debug('xnrem = ' + xnrem);\n            logger.debug('d = ' + d);\n        }\n        if (d.isZero()) {\n            return [new PolynomialMP(this.indet, this.ar, this.mod),\n                    1,\n                    new PolynomialMP(this.indet, [1], this.mod)];\n        }\n        var g = xnrem.gcd(d).toMonic();\n        logger.debug('g = ' + g);\n        if (g.deg() <= 0) {\n            var sfpol = g.mul(xn);\n            return [xn, 1, xnrem];\n        }\n\n        var t = xnrem.divRem(g);\n        if (logger.isDebugEnabled()) {\n            logger.debug('t[0] = ' + t[0]);\n            logger.debug('t[1] = ' + t[1]);\n        }\n        var q = t[0];\n        var r = t[1];\n        t = g.gcd(t[0]);\n        if (t.deg() < 1) {\n            return [g.mul(xn), 1, q];\n        }\n        var sqf = g;\n        g = t;\n        //g = g.gcd(t[0]).toMonic();\n        // var q = xnrem.divRem(g)[0];\n        q = q.divRem(g)[0];\n        if (logger.isDebugEnabled()) {\n            logger.debug('g = ' + g);\n            logger.debug('q = ' + q);\n        }\n        var n = 1;\n        while(q.deg() > 0) {\n            t = q.divRem(g);\n            var r = t[1];\n            if (!r.isZero()) {\n                return [this.divRem(q)[0], 1, q];\n            }\n            q = t[0];\n            n++;\n        }\n        return [this.divRem(q)[0], 1, q];\n    }\n    getXn() {\n        var n = 0;\n        for (var i = 0; i <= this.deg(); i++) {\n            if (this.ar[i] != 0) {\n                n = i;\n                break;\n            }\n        }\n        var xar = new Array(n + 1).fill(0);\n        // console.log('n = ' + n);\n        xar[n] = 1;\n        // console.log(xar);\n        var r1 = new PolynomialMP(this.indet, xar, this.mod);\n        var r2 = this.divRem(r1)[0];\n        return [r1, r2];\n    }\n\n    /*\n     * gcd of coefficients\n     */\n    gcdK() {\n        // var d = this.deg();\n        // if (d == -1) {\n        //     return 0;\n        // }\n        return arGcdK(this.ar);\n    }\n    gcdDiv() {\n        var d = this.deg();\n        if (d == -1) {\n            return this;\n        }\n        var g = arGcdK(this.ar);\n        var ar = arDivK(this.ar, g);\n        return new PolynomialMP(this.indet, ar, this.mod, this.base);\n    }\n    mul(pol) {\n        if (this.indet != pol.indet || this.mod != pol.mod) {\n            throw new Error('indetermint mismatch');\n        }\n        if (this.isZero() || pol.isZero()) {\n            return new PolynomialMP(this.indet, [0], this.mod, this.base);\n        }\n        var pdeg = pol.deg();\n        var ar = new Array(this.deg() + pdeg + 1).fill(0);\n        for (var i = 0; i <= pdeg; i++) {\n            var k = pol.ar[i];\n            if (k != 0) {\n                arAddMulShift(ar, this.ar, k, i);\n            }\n        }\n        return new PolynomialMP(this.indet, ar, this.mod, this.base);\n    }\n    canBeMonic() {\n        const lk = this.leadingK();\n        if (lk == 1) {\n            return true;\n        }\n        if (this.mod == this.base) {\n            return true;\n        } else if (lk % this.base != 0) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n    toMonic() {\n        const lk = this.leadingK();\n        if (lk == 1) {\n            return this;\n        }\n        var inv;\n        if (this.mod == this.base) {\n            inv = inverse(lk, this.mod);\n        } else if (lk % this.base != 0) {\n            inv = inverse(lk, this.mod);\n        } else {\n            logger.fatal('cannot change to monic :' + this.toString());\n            throw new Error('cannot change to monic');\n        }\n        var ar = this.ar.concat();\n        for (var i = 0; i < ar.length; i++) {\n            ar[i] = ar[i] * inv;\n        }\n        return new PolynomialMP(this.indet, ar, this.mod, this.base);\n    }\n    gt(pol) {\n        if (this.indet != pol.indet || this.mod != pol.mod) {\n            throw new Error('indetermint mismatch');\n        }\n        return arGt(this.ar, pol.ar);\n    }\n    /*\n     * 余り付き割り算\n     * return [p, r], where p*pol + r = this\n     */\n    divRem(pol) {\n        if (this.indet != pol.indet || this.mod != pol.mod) {\n            throw new Error('indetermint mismatch');\n        }\n        if (this.isZero()) {\n            return [new PolynomialMP(this.indet, [0], this.mod, this.base),\n                    new PolynomialMP(this.indet, [0], this.mod, this.base)];\n        }\n        if (pol.isZero()) {\n            throw new Error('zero divide');\n        }\n        if (this.deg() < pol.deg()) {\n            return [new PolynomialMP(this.indet, [0], this.mod, this.base),\n                    new PolynomialMP(this.indet, this.ar, this.mod, this.base)];\n        }\n        if (this.base == this.mod) {\n            return this.divRem1(pol);\n        } else {\n            return this.divRem2(pol);\n        }\n    }\n    /*\n     * mod p の場合\n     */\n    divRem1(pol) {\n        // console.log('in divRem1');\n        var tl = arLeadingK(this.ar);\n        var pl = arLeadingK(pol.ar);\n        const invpl = inverse(pl, this.mod);\n        var diff = this.deg() - pol.deg();\n        const ar = new Array(diff+1);\n        for (var i = 0; i <= diff; i++) {\n            ar[i] = 0;\n        }\n        var mul = (tl * invpl) % this.mod;\n        // console.log('mul = ' + mul);\n        ar[diff] = mul;\n        var tmp = this.ar.concat();\n        // console.log('tmp = ' + arToString('x', tmp));\n        arAddMulShift(tmp, pol.ar, this.mod - mul, diff);\n        // console.log('tmp = ' + arToString('x', tmp));\n        arStandard(tmp, this.mod);\n        // console.log('tmp = ' + arToString('x', tmp));\n        // console.log('divrem ar = ' + arToString('x', ar));\n        // console.log('divrem tmp = ' + arToString('x', tmp));\n        // console.log('divrem pol = ' + arToString('x', pol));\n        //var cnt = diff;\n        diff = arDeg(tmp) - pol.deg();\n        while (diff >= 0) {\n            // if (cnt < 0) {\n            //     throw new Error('count over');\n            // }\n            // cnt--;\n            // console.log('divrem ar = ' + arToString('x', ar));\n            // console.log('divrem tmp = ' + arToString('x', tmp));\n            // console.log('divrem pol = ' + arToString('x', pol));\n            tl = arLeadingK(tmp);\n            mul = (tl * invpl) % this.mod;\n            ar[diff] = mul;\n            arAddMulShift(tmp, pol.ar, -mul, diff);\n            arStandard(tmp, this.mod);\n            diff = arDeg(tmp) - pol.deg();\n        }\n        return [new PolynomialMP(this.indet, ar, this.mod, this.base),\n                new PolynomialMP(this.indet, tmp, this.mod, this.base)];\n    }\n    /*\n     * mod p^n の場合\n     */\n    divRem2(pol) {\n        var tl = arLeadingK(this.ar);\n        var pl = arLeadingK(pol.ar);\n        var inversible = false;\n        var invpl;\n        var mul;\n        if (pl % pol.base != 0) {\n            inversible = true;\n            invpl = inverse(pl, this.mod);\n            mul = (tl * invpl) % this.mod;\n        } else if (tl % pl == 0) {\n            mul = Math.trunc(tl / pl);\n        } else {\n            return [new PolynomialMP(this.indet, [0], this.mod, this.base),\n                    new PolynomialMP(this.indet, this.ar, this.mod, this.base)];\n        }\n        var diff = this.deg() - pol.deg();\n        const ar = new Array(diff+1);\n        for (var i = 0; i <= diff; i++) {\n            ar[i] = 0;\n        }\n        ar[diff] = mul;\n        var tmp = this.ar.concat();\n        arAddMulShift(tmp, pol.ar, -mul, diff);\n        arStandard(tmp, this.mod);\n        // console.log('divrem ar = ' + arToString('x', ar));\n        // console.log('divrem tmp = ' + arToString('x', tmp));\n        // console.log('divrem pol = ' + arToString('x', pol));\n        //var cnt = diff;\n        diff = arDeg(tmp) - pol.deg();\n        while (diff >= 0) {\n            // if (cnt < 0) {\n            //     throw new Error('count over');\n            // }\n            // cnt--;\n            // console.log('divrem ar = ' + arToString('x', ar));\n            // console.log('divrem tmp = ' + arToString('x', tmp));\n            // console.log('divrem pol = ' + arToString('x', pol));\n            tl = arLeadingK(tmp);\n            if (inversible) {\n                mul = (tl * invpl) % this.mod;\n            } else if (tl % pl == 0) {\n                mul = Math.trunc(tl / pl);\n            } else {\n                return [new PolynomialMP(this.indet, ar, this.mod, this.base),\n                        new PolynomialMP(this.indet, tmp, this.mod, this.base)];\n            }\n            ar[diff] = mul;\n            arAddMulShift(tmp, pol.ar, -mul, diff);\n            arStandard(tmp, this.mod);\n            diff = arDeg(tmp) - pol.deg();\n        }\n        return [new PolynomialMP(this.indet, ar, this.mod, this.base),\n                new PolynomialMP(this.indet, tmp, this.mod, this.base)];\n    }\n    gcd(pol) {\n        if (this.indet != pol.indet || this.mod != pol.mod) {\n            throw new Error('indetermint mismatch');\n        }\n        if (this.deg() < pol.deg()) {\n            return pol.gcd(this);\n        }\n        var a = this;\n        var b = pol;\n        while (!b.isZero()) {\n            var t = b;\n            var c = a.divRem(b);\n            b = c[1];\n            a = t;\n        }\n        return a;\n    }\n    exGcd(pol) {\n        if (this.indet != pol.indet || this.mod != pol.mod) {\n            throw new Error('indetermint mismatch');\n        }\n        if (this.isZero() || pol.isZero()) {\n            throw new Error('not supported');\n        }\n        if (this.deg() < pol.deg()) {\n            var x = pol.exGcd(this);\n            return [x[1], x[0], x[2]];\n        }\n        const zero = new PolynomialMP(this.indet, [0], this.mod, this.base);\n        const one = new PolynomialMP(this.indet, [1], this.mod, this.base);\n        var r0 = this;\n        var r1 = pol;\n        var a0 = one;\n        var a1 = zero;\n        var b0 = zero;\n        var b1 = one;\n        while (!r1.isZero()) {\n            var tmp = r0.divRem(r1);\n            var q1 = tmp[0];\n            var r2 = tmp[1];\n            var a2 = a0.sub(q1.mul(a1));\n            var b2 = b0.sub(q1.mul(b1));\n            r0 = r1;\n            r1 = r2;\n            a0 = a1;\n            a1 = a2;\n            b0 = b1;\n            b1 = b2;\n        }\n        if (r0.deg() == 0 && r0.leadingK() != 1) {\n            var inv = inverse(r0.leadingK(), this.mod);\n            a0 = a0.mulK(inv);\n            b0 = b0.mulK(inv);\n            r0 = r0.mulK(inv);\n        }\n        return [a0, b0, r0];\n    }\n    powerP() {\n        return new PolynomialMP(this.indet,\n                                arPowerP(this.ar, this.base),\n                                this.base);\n    }\n    power(n) {\n        if (n < 0 || !Number.isInteger(n)) {\n            throw new Error('not supported');\n        }\n        var x = this;\n        var res = new PolynomialMP(this.indet, [1], this.mod, this.base);\n        while (n != 0) {\n            if ((n % 2) == 1) {\n                res = res.mul(x);\n            }\n            x = x.mul(x);\n            n = n >> 1;\n        }\n        return res;\n    }\n\n    powerPMod(modp) {\n        // logger.debug('this = ' + this);\n        // logger.debug('modp = ' + modp);\n        if (modp.isZero()) {\n            throw new Error('zero divide');\n        }\n        var tmp = new PolynomialMP(this.indet,\n                                   arPowerP(this.ar, this.base),\n                                   this.base);\n        return tmp.divRem(modp)[1];\n    }\n\n    powerMod(n, modp) {\n        if (n < 0 || !Number.isInteger(n)) {\n            throw new Error('not supported');\n        }\n        if (modp.isZero()) {\n            throw new Error('zero divide');\n        }\n        var x = this;\n        var res = new PolynomialMP(this.indet, [1], this.mod, this.base);\n        while (n != 0) {\n            if ((n % 2) == 1) {\n                res = res.mul(x);\n                res = res.divRem(modp)[1];\n            }\n            //console.log(x);\n            x = x.mul(x);\n            x = x.divRem(modp)[1];\n            n = n >> 1;\n        }\n        return res;\n    }\n\n    // powerModN(n, modp) {\n    //     if (ln instanceof LongNum) {\n    //         return powerModLN(n, modp);\n    //     } else {\n    //         return powerMod(n, modp);\n    //     }\n    // }\n\n    // /*\n    //  * Long Number による powerMod\n    //  */\n    // powerModLN(ln, modp) {\n    //     if (!(ln instanceof LongNum)) {\n    //         logger.fatal('ln should be instance of LongNum');\n    //         throw new Error('not supported');\n    //     }\n    //     if (modp.isZero()) {\n    //         throw new Error('zero divide');\n    //     }\n    //     // logger.debug('ln = ' + ln.toString(2) + ' modp = ' + modp);\n    //     var x = this;\n    //     var res = new PolynomialMP(this.indet, [1], this.mod, this.base);\n    //     for (let pos = 0; pos <= ln.bitLen(); pos++) {\n    //         // if (logger.isDebugEnabled()) {\n    //         //     logger.debug('pos = ' + pos);\n    //         //     logger.debug('ln.bitLen() = ' + ln.bitLen());\n    //         //     logger.debug('x = ' + x);\n    //         //     logger.debug('res = ' + res);\n    //         //     logger.debug('ln.getBit(pos) = ' + ln.getBit(pos));\n    //         // }\n    //         if (ln.getBit(pos)) {\n    //             // logger.debug('res1 = ' + res);\n    //             res = res.mul(x);\n    //             // logger.debug('res2 = ' + res);\n    //             if (res.deg() >= modp.deg()) {\n    //                 res = res.divRem(modp)[1];\n    //             }\n    //             // logger.debug('res3 = ' + res);\n    //         }\n    //         x = x.mul(x);\n    //         if (x.deg() >= modp.deg()) {\n    //             x = x.divRem(modp)[1];\n    //         }\n    //         // logger.debug('x = ' + x);\n    //         // logger.debug('res = ' + res);\n    //     }\n    //     return res;\n    // }\n}\n\n//module.exports = Polynomial;\nexports.Polynomial = Polynomial;\nexports.PolynomialMP = PolynomialMP;\n\nexports.arToString = arToString;\nexports.arStandard = arStandard;\nexports.arEqual = arEqual;\nexports.arDeg = arDeg;\nexports.arLeadingK = arLeadingK;\nexports.arMaxK = arMaxK;\nexports.arAdd = arAdd;\nexports.arAddMulShift = arAddMulShift;\nexports.arSub = arSub;\nexports.arGt = arGt;\nexports.arXn = arXn;\nexports.arRandom = arRandom;\n","class Sosu {\n    static PRIMES = [\n        2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61,\n        67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137,\n        139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199,\n        211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277,\n        281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359,\n        367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439,\n        443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521,\n        523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607,\n        613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683,\n        691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773,\n        787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863,\n        877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967,\n        971, 977, 983, 991, 997];\n    static MaxPrime = 997;\n    static getPrimes() {\n        return Sosu.PRIMES.concat();\n    }\n    static getMaxPrime() {\n        return Sosu.MaxPrime;\n    }\n    static getPrimesTo(n) {\n        var p = new Array(n+1).fill(1);\n        p[0] = 0;\n        p[1] = 0;\n        for (var i = 2; i <= n; i++) {\n            if (p[i] != 1) {\n                continue;\n            }\n            var q = i;\n            for (var j = 2; q * j <= n; j++) {\n                p[q*j] = 0;\n            }\n        }\n        var res = [];\n        for (var i = 0; i < p.length; i++) {\n            if (p[i] == 1) {\n                res.push(i);\n            }\n        }\n        return res;\n    }\n    static integerFactorize(num) {\n        num = Math.trunc(num);\n        var res = [];\n        if (num > Sosu.MaxPrime * Sosu.MaxPrime) {\n            return res;\n        }\n        while (num > 1) {\n            for (var i = 0; i < Sosu.PRIMES.length; i++) {\n                var p = Sosu.PRIMES[i];\n                if (num % p == 0) {\n                    num = num / p;\n                    res.push(p);\n                    break;\n                }\n            }\n        }\n        return res;\n    }\n}\n\nclass MulCMB {\n    // var idx;\n    // var ar;\n    constructor(array) {\n        this.ar = array.concat();\n        this.idx = 0;\n    }\n    done() {\n        return this.idx >= 2**this.ar.length;\n    }\n    reset() {\n        this.idx = 0;\n    }\n    next() {\n        if (this.done()) {\n            return false;\n        }\n        var res = 1;\n        var x = this.idx;\n        var y = 0;\n        this.idx++;\n        while (x > 0) {\n            if (x % 2 == 1) {\n                res = res * this.ar[y];\n            }\n            x = Math.trunc(x / 2);\n            y++;\n        }\n        return res;\n    }\n    getList() {\n        var result = [];\n        while (!this.done()) {\n            var el = this.next();\n            if (!result.includes(el)) {\n                result.push(el);\n            }\n        }\n        return result;\n    }\n}\n\nexports.Sosu = Sosu;\nexports.MulCMB = MulCMB;\n","/**\n * @file tinymtjs.js\n *\n * @brief Tiny Mersenne Twister for Java Script.\n * Intitialization functions are modified to fit Javascript numbers.\n *\n * Originai authors:\n * @author Mutsuo Saito (Hiroshima University)\n * @author Makoto Matsumoto (The University of Tokyo)\n *\n * Copyright (C) 2011 Mutsuo Saito, Makoto Matsumoto,\n * Hiroshima University and The University of Tokyo.\n * All rights reserved.\n *\n * modified by\n * @author Taro Suginami\n * Copyright (C) 2022 Taro Suginami.\n * All rights reserved.\n *\n * original program is TinyMT32.java\n * http://www.math.sci.hiroshima-u.ac.jp/m-mat/MT/TINYMT/JAVA/index.html\n *\n * parameters, (mat1, mat2, tmat) are taken from\n * http://www.math.sci.hiroshima-u.ac.jp/m-mat/MT/TINYMT/DATA/index.html\n * tinymt32dc.0-4.65536.tar.gz\n * tinymt32dc.0.65536.txt\n * last line\n * ab5a14fcfae73ebad2addf92bef887b1,32,0,e99e1d33,42f090bd,ac3ff3ff,77,0\n *\n */\n/*\nCopyright (c) 2011, 2013 Mutsuo Saito, Makoto Matsumoto,\nHiroshima University and The University of Tokyo.\nAll rights reserved.\nCopyright (C) 2022 Taro Suginami.\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n    * Neither the name of the Hiroshima University nor the names of\n      its contributors may be used to endorse or promote products\n      derived from this software without specific prior written\n      permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n\"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nconst MMMM    = 0xffffffff;\nconst UNSMASK = 0x7fffffff;\nconst MIN_LOOP = 8;\nconst MASK = 0x7fffffff;\nconst MAT1 = 0xe99e1d33;\nconst MAT2 = 0x42f090bd;\nconst TMAT = 0xac3ff3ff;\nconst SH0 = 1;\nconst SH1 = 10;\nconst SH8 = 8;\n\nfunction ini_func1JS(x) {\n    x = (x ^ (x >>> 27) ^ (x << 19)) & UNSMASK;\n    return (x * 26125) & MMMM;\n}\nfunction ini_func2JS(x) {\n    x = (x ^ (x >>> 27) ^ (x << 19)) & UNSMASK;\n    return (x * 559973) & MMMM;\n}\n\nclass TinyMTJS {\n    constructor(seed) {\n        this.st0 = 0;\n        this.st1 = 0;\n        this.st2 = 0;\n        this.st3 = 0;\n        this.setSeed(seed);\n    }\n    setSeed(seed) {\n        if (typeof seed === 'string' || seed instanceof String) {\n            var aseed = seed.split('').map((v) => v.charCodeAt());\n            this.setSeedArray(aseed);\n        } else if (Array.isArray(seed)) {\n            this.setSeedArray(seed);\n        } else {\n            this.setSeedNumber(seed);\n        }\n    }\n    // Seeding for Java Script, modified by Taro Suginami\n    // private\n    setSeedNumber(seed) {\n        var status = Array(4);\n        status[0] = seed & MMMM;\n        status[1] = MAT1;\n        status[2] = MAT2;\n        status[3] = TMAT;\n        for (var i = 1; i < MIN_LOOP; i++) {\n            var x = status[(i - 1) & 3];\n            x = x ^ (x >>> 30) ^ (x << 17);\n            status[i & 3] ^= i + 30157 * (x & UNSMASK);\n        }\n        this.st0 = status[0];\n        this.st1 = status[1];\n        this.st2 = status[2];\n        this.st3 = status[3];\n        if (((this.st0 & MASK) == 0) &&\n            (this.st1 == 0) &&\n            (this.st2 == 0) &&\n            (this.st3 == 0)) {\n            this.st0 = 'T'.charCodeAt(0);\n            this.st1 = 'I'.charCodeAt(0);\n            this.st2 = 'N'.charCodeAt(0);\n            this.st3 = 'Y'.charCodeAt(0);\n        }\n        for (var i = 0; i < MIN_LOOP; i++) {\n            this.next();\n        }\n    }\n    // Seeding for Java Script, modified by Taro Suginami\n    // private\n    setSeedArray(init_key) {\n        if (!Array.isArray(init_key)) {\n            throw new Error('TinyMTJS.setSeedArray: Seed type mismatch.');\n        }\n        const lag = 1;\n        const mid = 1;\n        const size = 4;\n        var i;\n        var j;\n        var count;\n        var r;\n        var status = Array(4);\n        var key_length;\n\n        key_length = init_key.length;\n        status[0] = 0;\n        status[1] = MAT1;\n        status[2] = MAT2;\n        status[3] = TMAT;\n        if (key_length + 1 > MIN_LOOP) {\n            count = key_length + 1;\n        } else {\n            count = MIN_LOOP;\n        }\n        r = ini_func1JS(status[0] ^ status[mid % size] ^\n                        status[(size - 1) % size]);\n        status[mid % size] = (status[mid % size] + r) & MMMM;\n        r = (r + key_length);// & UNSMASK;\n        status[(mid + lag) % size] = (status[(mid + lag) % size] + r) & MMMM;\n        status[0] = r;\n        count--;\n        for (i = 1, j = 0; (j < count) && (key_length > 0); j++) {\n            r = ini_func1JS(status[i % size] ^\n                            status[(i + mid) % size] ^\n                            status[(i + size - 1) % size]);\n            status[(i + mid) % size] = (status[(i + mid) % size] + r) & MMMM;\n            r = (r + init_key[j % key_length] + i) & MMMM;\n            status[(i + mid + lag) % size] =\n                (status[(i + mid + lag) % size] + r) & MMMM;\n            status[i % size] = r;\n            i = (i + 1) % size;\n        }\n        for (j = 0; j < size; j++) {\n            r = ini_func2JS(status[i % size] +\n                            status[(i + mid) % size] +\n                            status[(i + size - 1) % size]);\n            status[(i + mid) % size] ^= r;\n            r -= i;\n            status[(i + mid + lag) % size] ^= r;\n            status[i % size] = r;\n            i = (i + 1) % size;\n        }\n        this.st0 = status[0];\n        this.st1 = status[1];\n        this.st2 = status[2];\n        this.st3 = status[3];\n        if (((this.st0 & MASK) == 0) &&\n            (this.st1 == 0) &&\n            (this.st2 == 0) &&\n            (this.st3 == 0)) {\n            this.st0 = 'T'.charCodeAt(0);\n            this.st1 = 'I'.charCodeAt(0);\n            this.st2 = 'N'.charCodeAt(0);\n            this.st3 = 'Y'.charCodeAt(0);\n        }\n        for (var i = 0; i < MIN_LOOP; i++) {\n            this.next();\n        }\n    }\n\n    getInt31() {\n        var v = this.next();\n        return v >>> 1;\n    }\n\n    getDouble31() {\n        return (this.getInt31() * 1.0) / 0x80000000;// 31bit int to double\n    }\n\n    getInt(max) {\n        return Math.floor(this.getDouble31() * max);\n    }\n\n    next() {\n        var y = this.st3;\n        var x = (this.st0 & MASK) ^ this.st1 ^ this.st2;\n        x ^= (x << SH0) & MMMM;\n        y ^= (y >>> SH0) ^ x;\n        this.st0 = this.st1;\n        this.st1 = this.st2;\n        this.st2 = x ^ ((y << SH1) & MMMM);\n        this.st3 = y;\n        if ((y & 1) == 1) {\n            this.st1 ^= MAT1;\n            this.st2 ^= MAT2;\n        }\n        var t0 = this.st3;\n        var t1 = (this.st0 + (this.st2 >>> SH8)) & MMMM;\n        t0 ^= t1;\n        if ((t1 & 1) == 1) {\n            t0 ^= TMAT;\n        }\n        return t0;\n    }\n}\n\nexports.TinyMTJS = TinyMTJS;\n","function ones32(x) {\n    /* 32-bit recursive reduction using SWAR...\n       but first step is mapping 2-bit values\n       into sum of 2 1-bit values in sneaky way\n    */\n    /*\n     * なお、javascript では31ビットまでしか扱えない\n     */\n    x &= 0x7fffffff;\n    x -= ((x >> 1) & 0x55555555);\n    x = (((x >> 2) & 0x33333333) + (x & 0x33333333));\n    x = (((x >> 4) + x) & 0x0f0f0f0f);\n    x += (x >> 8);\n    x += (x >> 16);\n    return(x & 0x0000003f);\n}\n\n/*\n * array 要素からちょうど num 個選んで返す\n * 多項式の次数が増えても、個数優先でよい（はず）\n */\nfunction* combgenerator(ar, num) {\n    const array = ar.concat();\n    if (num == 1) {\n        for (var i = 0; i < array.length; i++) {\n            yield array[i];\n        }\n        return;\n    }\n    var idx = 1;\n    const maxidx = 2**array.length;\n    while (idx < maxidx) {\n        if (ones32(idx) == num) {\n            const result = [];\n            var tmp = idx;\n            var p = 0;\n            while (tmp > 0) {\n                if (tmp & 1) {\n                    result.push(array[p]);\n                }\n                tmp = tmp >> 1;\n                p++;\n            }\n            yield result;\n        }\n        idx++\n    }\n}\n\nfunction* createCombinationGenerator(xs, r) {\n  if (xs.length < r) {\n    return;\n  }\n  if (r == 1) {\n    for (let x of xs) {\n      yield [x];\n    }\n    return;\n  }\n  const x = xs[0];\n  const xs_ = xs.slice(1);\n  for (let comb of createCombinationGenerator(xs_, r - 1)) {\n    yield [x, ...comb];\n  }\n  for (let comb of createCombinationGenerator(xs_, r)) {\n    yield comb;\n  }\n}\n\nfunction* createCombinationGeneratorAll(array) {\n    const xs = array.concat();\n    for (var r = 1; r <= xs.length; r++) {\n        for (let comb of createCombinationGenerator(xs, r)) {\n            yield comb;\n        }\n    }\n}\n\nexports.ones32 = ones32;\nexports.combgenerator = combgenerator;\nexports.createCombinationGenerator = createCombinationGenerator;\nexports.createCombinationGeneratorAll = createCombinationGeneratorAll;\n","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n      return ContinueSentinel;\n    }\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) {\n              if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            }\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {\n        \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n      }\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const polymodule = require('./polynomial');\nconst kzmodule = require('./kz');\n//const sosumd = require('./sosu');\nconst Polynomial = polymodule.Polynomial;\n//const PolynomialMP = polymodule.PolynomialMP;\nconst KZ = kzmodule.KZ;\n//const Sosu = sosumd.Sosu;\n\nconst MAX_K = 1000;\nvar app = {};\napp.poly = '';\n\nfunction dispButton() {\n    const indet = document.getElementById('indet').value.trim();\n    const keisu = document.getElementById('keisu').value.trim();\n    if (keisu.match(/[0-9]*[a-zA-Z]/)) {\n        app.poly = Polynomial.fromString2(keisu);\n    } else {\n        const array = keisu.split(/ +/).map(x => parseInt(x,10));\n        if (array.length > 0) {\n            app.poly = new Polynomial(indet[0], array.reverse());\n        }\n    }\n    const sp = document.getElementById('disppoly');\n    var str = app.poly.toDescString();\n    str = str.replaceAll(/\\^([0-9]+)/g, \"<sup>$1</sup>\");\n    sp.innerHTML = str;\n}\n\nfunction fzButton() {\n    if (app.poly instanceof Polynomial) {\n        const kz = new KZ(app.poly);\n        kz.factorize();\n        var str = kz.getStringFactors();\n        str = str.replaceAll(/\\^([0-9]+)/g, \"<sup>$1</sup>\");\n        const sp = document.getElementById('result');\n        sp.innerHTML = str;\n    }\n}\n\nfunction processDark() {\n    const userMod = window.matchMedia('(prefers-color-scheme: dark)').matches;\n    const sMode = window.sessionStorage.getItem('user');\n    const el = document.documentElement;\n\n    if(sMode) {\n        el.setAttribute('theme', sMode);\n    } else {\n        if(userMod == true) {\n            el.setAttribute('theme', 'dark');\n        } else {\n            el.setAttribute('theme', 'light');\n        }\n    }\n\n    document.getElementById(\"changeMode\").onclick = function() {\n        const nowMode = el.getAttribute('theme');\n        if(nowMode == 'dark') {\n            el.setAttribute('theme', 'light');\n            window.sessionStorage.setItem('user', 'light');\n        } else {\n            el.setAttribute('theme', 'dark');\n            window.sessionStorage.setItem('user', 'dark');\n        }\n    };\n}\n\nfunction setOnClick() {\n    const disp = document.getElementById('disp');\n    const factorize = document.getElementById('factorize');\n    disp.onclick = dispButton;\n    factorize.onclick = fzButton;\n}\n\nfunction init(prarray, prtype) {\n    processDark();\n    setOnClick();\n}\n\nwindow.onload = init;\n"],"names":["gcdInt","x","y","gcdInt2","Math","abs","a","b","t","exgcd","Error","r0","r1","a0","a1","b0","b1","q1","trunc","r2","a2","b2","exports","lcmInt","inverse","mod","r","polymodule","require","eucmodule","sosumd","tinymd","utlmd","Polynomial","PolynomialMP","Sosu","MulCMB","TinyMTJS","createCombinationGeneratorAll","logger","getLogger","randomPMP","indet","deg","tiny","ar","Array","i","getInt","arModToInt","array","mul","concat","half","length","czpower","poly","p","d","modp","m","fp","f","base","n","power","divRem","powerP","reduceFactor","factor","debug","result","forEach","el","e","find","equal","push","fzfp","freeMP","prime","tinymt","isDebugEnabled","toString","toMonic","one","tee","tp","powerPMod","free","ddfactors","cnt","tmp","sub","g","gcd","pr","ddf","irrplist","map","pair","fatal","inlist","outlist","inlist2","rndp","gcdp","edfcz","flat","sort","gt","fczMP1","sqf","diffP","isZero","ar1","ar2","finish","powerOfMP","res","squareFreeMP","factors","pol","selectPrime","lk","least","max","primes","getPrimes","lift","gb","hb","fb","exGcd","gn","hn","g0","h0","nextMod","fn","fromPolynomial","toNewMod","q","pn","qn","add","liftFactors","canBeMonic","uniqPush","checkAndm","orig","lkFactors","integerFactorize","leadingK","reduce","c","info","p2","mcmlist","getList","divrem","Logger","level","KZ","this","original","w","gcdKPX","gcdK","gcdP","resultFactors","firstFactor","gcdPol","success","fz0","leastPrime","sqfct","squareFactor","fz1","filter","fz2","maxK","sq","rem","sqf2","sqfactors","sqlifted","lifted","origlifted","origtarget","incomp","targetpol","doubtfuls","liftedcomb","found","plar","some","includes","checkFactors","intfactors","db","fc","desc","s","kxn","k","seed","workPol","xn","getXn","preList","mulK","Log4JSDummyLogger","euclid","arDeg","arEqual","deg1","arToString","sep","arToDescString","arPowerP","fill","pop","arShorten","arStandard","arLeadingK","arMaxK","arAdd","deg2","arGt","arAddMulShift","shift","arSub","arDivK","arGcdK","sign","arRandom","random","str","arIsTanko","toDescString","pdeg","xar","tl","pl","diff","kmulxn","gcdKP","ak","bk","gcdX","remX","gcdY","console","log","remY","sar","split","parseInt","replaceAll","star","match","replace","term","standard","dispmod","arMulK","xnpr","xnrem","inv","divRem1","divRem2","invpl","inversible","zero","Number","isInteger","arXn","PRIMES","MaxPrime","j","num","idx","done","next","MMMM","UNSMASK","MASK","MAT1","MAT2","TMAT","ini_func1JS","st0","st1","st2","st3","setSeed","String","aseed","v","charCodeAt","setSeedArray","isArray","setSeedNumber","status","init_key","count","key_length","mid","getInt31","floor","getDouble31","t0","t1","combgenerator","createCombinationGenerator","ones32","maxidx","xs","xs_","slice","comb","module","arr","len","arr2","__esModule","arrayLikeToArray","instance","Constructor","TypeError","_defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","obj","value","iter","Symbol","iterator","from","_typeof","_regeneratorRuntime","Op","hasOwn","hasOwnProperty","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","undefined","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","val","object","reverse","skipTempReset","prev","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","thrown","delegateYield","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","o","minLen","test","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","kzmodule","app","dispButton","document","getElementById","trim","keisu","fromString2","sp","innerHTML","fzButton","kz","factorize","getStringFactors","window","onload","prarray","prtype","userMod","sMode","disp","matchMedia","matches","sessionStorage","getItem","documentElement","setAttribute","onclick","getAttribute","setItem"],"sourceRoot":""}